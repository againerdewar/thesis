\documentclass[sectionflow,singlespace,twoside,boldmathhdr,draft]{brandiss} % Compactify for drafting (do *not* use these options for final submission!)
% \documentclass[sectionflow,singlespace,twoside,boldmathhdr]{brandiss} % Pretty version for distribution (*not* for GSAS submission!)
% \documentclass[online,boldmathhdr]{brandiss} % Online version (states that signature page is on file)
% \documentclass[boldmathhdr]{brandiss} % Print version

\usepackage{argthesis}

% \makeindex

% Optional: Number sections and figures within chapters.
\numberwithin{section}{chapter}
\numberwithin{figure}{chapter}

% REQUIRED: Dissertation information.
\disstitle{$\Gamma$-species, Quotients, and Graph Enumeration}
\dissauthor{Andrew Gainer}
\dissadvisor{Ira Gessel}
\dissdepartment{Mathematics}
\dissmonth{May}
\dissyear{2012}
\dissdean{Malcom Watson}

% The actual document begins.
\begin{document}

% GSAS formatting requirements: Front page order is title, signature,
% copyright, dedication, acknowledgements, abstact, preface, table of
% contents, list of figures, list of tables.

% REQUIRED: The start of roman-numbered plain pages.
\frontmatter

% REQUIRED: Create the dissertation title page.
\makedisstitle

\begin{comment}
  % REQUIRED: Create the signature page.  Add one line for each member
  % of your dissertation committee, except for your advisor who is
  % automatically added before the rest.
  \begin{disssignatures}
    \committeemember Second Member, Dept.~of Mathematics
    \committeemember Third Member, Dept.~of Mathematics, Outside University
  \end{disssignatures}

  \disscopyright % optional

  \begin{dissdedication}
    A dedication is optional.
  \end{dissdedication}

  \begin{dissacknowledgments} % recommended
    I wish to thank my advisor for her help and support.

    I am grateful to the members of my dissertation defense committee.
    
    I owe thanks to the faculty, to my fellow students, and to the kind
    and supportive staff of the Brandeis Mathematics Department.
  \end{dissacknowledgments}
\end{comment}

% REQUIRED: The dissertation abstract.
\begin{dissabstract}
  The theory of $\Gamma$-species is developed to allow species-theoretic study of quotient structures in a categorically rigorous fashion.
  This new approach is then applied to two graph-enumeration problems which were previously unsolved in the unlabeled case---bipartite blocks and general $k$-trees.
\end{dissabstract}

\begin{disspreface}
  Historical study of enumerative combinatorial problems has often utilized the algebra of generating functions to simplify combinatorial operations.
  The theory of combinatorial species uses category theory to justify and systematize this practice, making clear the connections between structural manipulations of some objects of interest and algebraic manipulations of their associated generating functions.
  The notion of `quotient' enumeration (that is, of counting orbits under some group action) has been applied in species-theoretic contexts, but methods for doing so have largely been ad-hoc.
  We will contribute a species-compatible way for keeping track of the way a group $\Gamma$ acts on structures of a species $F$, yielding what we term a $\Gamma$-species, which has the sort of synergy of algebraic and structural data that we expect from species.
  We will then show that it is possible to extract information about the $\Gamma$-orbits of such a $\Gamma$-species and harness this new method to attack several unsolved problems in graph enumeration---in this case, the isomorphism classes of nonseparable bipartite graphs and $k$-trees.

  It is assumed that the reader of this thesis is familiar with the classical theory of groups and that he has encountered at least the basic vocabularies of category theory and graph theory.
  Results in these fields which are not original to this thesis will either be referenced from the literature or simply assumed, depending on the degree to which they are part of the standard body of knowledge one acquires when studying those disciplines.

  In the first chapter, we outline the theory of species, develop several classical methods, and introduce the notion of a $\Gamma$-species.
  In the second chapter, we apply these techniques to the enumeration of unlabeled $2$-connected bipartite graphs, a historically open problem.
  In the third chapter, we apply these techniques to the more complex problem of the enumeration of unlabeled general $k$-trees, also historically unsolved.
  Finally, in an appendix we discuss algebraic and computational methods which allow species-theoretical insights to be translated into explicit algorithmic techniques for enumeration.
\end{disspreface}

\setcounter{tocdepth}{2}
\tableofcontents % REQUIRED

\listoffigures % optional

\listoftables % optional

% REQUIRED: The start of arabic-numbered fancy pages.
\mainmatter

\chapter{The theory of species}\label{c:species}
\section{Introduction}\label{s:introspec}
Many of the most important historical problems in enumerative combinatorics have concerned the difficulty of passing from `labeled' to `unlabeled' structures.
In many cases, the algebra of generating functions has proved a powerful tool in analyzing such problems.
However, the general theory of the association between natural operations on classes of such structures and the algebra of their generating functions has been largely ad-hoc.
Andr\'{e} Joyal's introduction of the theory of combinatorial species in \cite{joy:species} provided the groundwork to formalize and understand this connection.
A full, pedagogical exposition of the theory of species is available in \cite{bll:species}, so we here present only an outline, largely tracking that text.

To begin, we wish to formalize the notion of a `construction' of a structure of some given class from a set of `labels', such as the construction of a graph from its vertex set or or that of a linear order from its elements.
The language of category theory will allow us capture this behavior succinctly yet with full generality:
\begin{definition}\label{def:species}
  Let $\catname{Bij}$ be the category of finite sets with bijections and $\catname{Set}$ be the category of finite sets with set maps.
  Then a \emph{species} is a functor $F: \catname{Bij} \to \catname{Set}$.
  For a set $A$ and a species $F$, an element of $F \sbrac{A}$ is an \emph{$F$-structure on $A$}.
  Moreover, for a species $F$ and a bijection $\phi: A \to B$, the bijection $F \sbrac{\phi}: F \sbrac{A} \to F \sbrac{B}$ is the \emph{$F$-transport of $\phi$}.
\end{definition}
A species functor $F$ simply associates to each set $A$ another set $F \sbrac{A}$ of its $F$-structures; for example, for $\specname{S}$ the species of permutations, we associate to some set $A$ the set $\specname{S} \sbrac{A} = \operatorname{Bij} \pbrac{A}$ of self-bijections (that is, permutations as maps) of $A$.

This definition is the original from \cite{joy:species}.
Since the image of a bijection under such a functor is a necessarily itself a bijection, many authors instead simply define a species as a functor $F: \catname{Bij} \to \catname{Bij}$.
Our motivation for using this definition instead will become clear in \S \ref{s:quot}.

Note that, having defined the species $F$ to be a functor, we have the following properties:
\begin{itemize}
\item for any two bijections $\alpha: A \to B$ and $\beta: B \to C$, we have $F \sbrac{\alpha \circ \beta} = F \sbrac{\alpha} \circ F \sbrac{\beta}$, and
\item for any set $A$, we have $F \sbrac{\Id_{A}} = \Id_{F \sbrac{A}}$.
\end{itemize}
Accordingly, we (generally) need not concern ourselves with the details of the set $A$ of labels we consider, so we will often restrict our attention to a canonical label set $\sbrac{n} := \cbrac{1, 2, \dots, n}$ for each cardinality $n$.
Moreover, the permutation group $\symgp{A}$ on any given set $A$ acts by self-bijections of $A$ and induces \emph{automorphisms} of $F$-structures for a given species $F$.
The orbits of $F$-structures on $A$ under the induced action of $\symgp{A}$ are then exactly the `unlabeled' structures of the class $F$, such as unlabeled graphs.

Finally, we note that it is sometimes natural to say that two \emph{species} are in fact `the same'.
It is not sufficient, of course, for the classes of $F$- and $G$-structures on each set $A$ to have the same cardinality; two such species could still have very different combinatorial structure.
However, if in addition to having the same cardinality, $F \sbrac{A}$ and $G \sbrac{A}$ have the same automorphism structure for all sets $A$, it seems more reasonable to claim $F$ and $G$ are \emph{combinatorially} equivalent.
The appropriate formalization again is most easily framed in categorical language:
\begin{definition}\label{def:speciso}
  Two species $F$ and $G$ are \emph{isomorphic} if there exists a natural transformation $\phi: F \to G$ which induces isomorphisms on structures; in other words, if there exists a family of bijections $\phi_{A}: F \sbrac{A} \to G \sbrac{A}$ (for all sets $A$) such that, for all bijections $\sigma: A \to B$, the following diagram commutes:
  \begin{equation*}
    \begin{tikzpicture}[every node/.style={auto}]
      \matrix (m) [matrix of math nodes, row sep=4em, column sep=4em]
      {
        F \sbrac{A} & G \sbrac{A} \\
        F \sbrac{B}  & G \sbrac{B} \\
      };
      \path[->]
      (m-1-1) edge node {$\phi_{A}$} (m-1-2)
      edge node {$F \sbrac{\sigma}$} (m-2-1)
      (m-1-2) edge node {$G \sbrac{\sigma}$} (m-2-2)
      (m-2-1) edge node {$\phi_{B}$} (m-2-2);
    \end{tikzpicture}
  \end{equation*}
\end{definition}
In the case that $F$ and $G$ are isomorphic species, we will often simply write $F = G$, since they are combinatorially equivalent; some authors instead use $F \simeq G$, reserving the notation of equality for the much stricter case that additionally requires that $F \sbrac{A} = G \sbrac{A}$ as sets for all $A$.

\section{Cycle indices and species enumeration}\label{s:cycind}
We now associate to the categorical theory of species an enumerative mechanism---a special power series which keeps track of all the automorphism structure of the species:
\begin{definition}
  \label{def:cycind}
  For a species $F$, define its \emph{cycle index series} to be the power series
  \begin{equation}
    \label{eq:cycinddef}
    \ci{F} \pbrac{p_{1}, p_{2}, \dots} := \sum_{n \geq 0} \frac{1}{n!} \big( \sum_{\sigma \in \symgp{n}} \fix \pbrac{F \sbrac{\sigma}} p_{1}^{\sigma_{1}} p_{2}^{\sigma_{2}} \dots \big) = \sum_{n \geq 0} \frac{1}{n!} \big( \sum_{\sigma \in \symgp{n}} \fix \pbrac{F \sbrac{\sigma}} p_{\sigma} \big)
  \end{equation}
  where $\fix \pbrac{F \sbrac{\sigma}} := \abs{\cbrac{s \in F \sbrac{A} : F \sbrac{\sigma} \pbrac{s} = s}}$, where $\sigma_{i}$ is the number of $i$-cycles of $\sigma$, and where $p_{i}$ are indeterminates.
  We will make extensive use of the compressed notation $p_{\sigma} = p_{1}^{\sigma_{1}} p_{2}^{\sigma_{2}} \dots$ hereafter.
\end{definition}

In fact, $\fix \pbrac{F \sbrac{\sigma}}$ is a class function\footnote{That is, the value of $\fix \pbrac{F \sbrac{\sigma}}$ will be constant on conjugacy classes of permutations, which we note are exactly the sets of permutations of fixed cycle type.} on permutations $\sigma \in \symgp{n}$.
Accordingly, we can instead consider all permutations of a given cycle type at once.
It is a classical theorem that conjugacy classes of permutations in $\symgp{n}$ are indexed by partitions $\lambda \vdash n$, which are defined as multisets of natural numbers whose sum is $n$.
In particular, conjugacy classes are determined by their cycle type, the multiset of the lengths of the cycles, which may clearly be identified bijectively with partitions of $n$.
For a given partition $\lambda \vdash n$, there are $n! / z_{\lambda}$ permutations of cycle type $\lambda$, where $z_{\lambda} := \prod_{i} i^{\lambda_{i}} \lambda_{i}!$ for $\lambda = \pbrac{1^{\lambda_{1}}, 2^{\lambda_{2}}, \dots}$.
Thus, we can instead write
\begin{equation}
  \label{eq:cycinddefpart}
  \ci{F} \pbrac{p_{1}, p_{2}, \dots} := \sum_{n \geq 0} \sum_{\lambda \vdash n} \fix \pbrac{F \sbrac{\lambda}} \frac{p_{1}^{\lambda_{1}} p_{2}^{\lambda_{2}} \dots}{z_{\lambda}} = \sum_{n \geq 0} \sum_{\lambda \vdash n} \fix \pbrac{F \sbrac{\lambda}} \frac{p_{\lambda}}{z_{\lambda}}
\end{equation}
for $\fix F \sbrac{\lambda} := \fix F \sbrac{\sigma}$ for some choice of a permutation $\sigma$ of cycle type $\lambda$.
Again, we will make extensive use of the notation $p_{\lambda} = p_{\sigma}$ hereafter.

That the cycle index $\ci{F}$ usefully characterizes the enumerative structure of the species $F$ may not be clear.
However, as the following theorems show, both labeled and unlabeled enumeration are immediately possible once the cycle index is in hand.
Recall that, for a given sequence $a = \pbrac{a_{1}, a_{2}, \dots}$, the \emph{ordinary generating function} of $a$ is the function $\tilde{A} \pbrac{x} = \sum_{i = 1}^{\infty} a_{i} x^{i}$ and the \emph{exponential generating function}  is the function $A \pbrac{x} = \sum_{i = 1}^{\infty} \frac{1}{i!} a_{i} x^{i}$.
The scaling factor of $\frac{1}{n!}$ in the exponential generating function is convenient in many contexts; for example, it makes differentiation of the generating function a combinatorially-significant operation.
The cycle index of a species is then directly related to two important generating functions:
\begin{theorem}\label{thm:ciegf}
  The exponential generating function $F \pbrac{x}$ of labeled $F$-structures is given by
  \begin{equation}\label{eq:ciegf}
    F \pbrac{x} = \ci{f} \sbrac{x, 0, 0, \dots}.
  \end{equation}
\end{theorem}
\begin{theorem}\label{thm:ciogf}
  The ordinary generating function $\tilde{F} \pbrac{x}$ of unlabeled $F$-structures is given by
  \begin{equation}\label{eq:ciogf}
    \tilde{F} \pbrac{x} = \ci{F} \sbrac{x, x^{2}, x^{3}, \dots}.
  \end{equation}
\end{theorem}
Proofs of both theorems are found in \cite[\S 1.2]{bll:species}.
In essence, equation \eqref{eq:ciegf} counts each labeled structure exactly once (as a fixed point of the trivial automorphism on $\sbrac{n}$) with a factor of $1/n!$, while equation \eqref{eq:ciogf} simply counts orbits \foreign{\`{a} la} Burnside's Lemma.
In cases where the unlabeled enumeration problem is interesting, it is generally more challenging than the labeled enumeration of the same structures, since the characterization of isomorphism in a species may be nontrivial to capture in a generating function.
If, however, we can calculate the complete cycle index for a species, both labeled and unlabeled enumerations immediately follow.

The use of $p_{i}$ for the variables instead of the more conventional $x_{i}$ alludes to the theory of symmetric functions, in which $p_{i}$ denotes the power-sum functions $p_{i} = \sum_{j} x_{j}^{i}$, which form an important basis for the ring $\Lambda$ of symmetric functions.
When the $p_{i}$ are understood as symmetric functions rather than simply indeterminates, additional P\'{o}lya-theoretic enumerative information is exposed.
In particular, the symmetric function in $x$-variables underlying a cycle index in $p$-variables may be said to count \emph{partially}-labeled structures of a given species, where the coefficient on a monomial $\prod x_{i}^{\alpha_{i}}$ counts structures with $\alpha_{i}$ labels of each sort $i$.
This serves to explain why the coefficients of powers of $p_{1} = \prod_{i} x_{i}$ counts labeled structures (where the labels must all be distinct) and why the automorphism types of structures are enumerated by $\ci{f} \pbrac{x, x^{2}, x^{3}, \cdots}$, which allows clusters of labels to be the same.
Another application of the theory of symmetric functions to the cycle indices of species may be found in \cite{gessel:laginvspec}.

Of course, it is not always obvious how to calculate the cycle index of a species directly.
However, in cases where we can decompose a species as some combination of simpler ones, we can exploit these relationships algebraically to study the cycle indices, as we will see in the next section.

\section{Algebra of species}\label{s:specalg}
It is often natural to describe a species in terms of combinations of other, simpler species---for example, `a permutation is a set of cycles' or `a rooted tree is a single vertex together with a (possibly empty) set of rooted trees'.
Several combinatorial operations on species of structures are commonly used to represent these kinds of combinations; that they have direct analogues in the algebra of cycle indices is in some sense the conceptual justification of the theory.
In particular, for species $F$ and $G$, will define species $F + G$, $F \cdot G$, $F \circ G$, $\pointed{F}$, and $F'$, and we will compute their cycle indices in terms of $\ci{F}$ and $\ci{G}$.
In what follows, we will not say explicitly what the effects of a given species operation are on bijections when those effects are obvious (as is usually the case).

\begin{definition}\label{def:specsum}
  For two species $F$ and $G$, define their \emph{sum} to be the species $F + G$ given by $\pbrac{F + G} \sbrac{A} = F \sbrac{A} \sqcup G \sbrac{A}$ (where $\sqcup$ denotes disjoint set union).
\end{definition}
In other words, an $\pbrac{F + G}$-structure is an $F$-structure \emph{or} a $G$-structure.
We use the disjoint union to avoid the complexities of dealing with cases where $F \sbrac{A}$ and $G \sbrac{A}$ overlap as sets.

\begin{theorem}\label{thm:specsumci}
  For species $F$ and $G$, the cycle index of their sum is
  \begin{equation}
    % \label{eq:specsumci}
    % \ci{F + G} = \ci{F} + \ci{G}.
  \end{equation}
\end{theorem}

We note that it is not in general possible to subtract species, as can readily be seen by considering a case of two species $F$ and $G$ where $\abs{F \sbrac{A}} < \abs{G \sbrac{A}}$ for some set $A$.
However, species addition is associative and commutative (up to species isomorphism), and furthermore the empty species $\mathbf{0}: A \mapsto \varnothing$ is an additive identity, so species with addition form an abelian monoid, which can be completed to create the abelian group of \emph{virtual species}.
We will not delve into the details of virtual species theory here, directing the reader instead to \cite[\S 2.5]{bll:species}.

\begin{definition}\label{thm:specprod}
  For two species $F$ and $G$, define their \emph{product} to be the species $F \cdot G$ given by $\pbrac{F \cdot G} \sbrac{A} = \sum_{A = B \sqcup C} F \sbrac{B} \times G \sbrac{C}$.
\end{definition}
In other words, an $\pbrac{F \cdot G}$-structure is a partition of $A$ into two sets $B$ and $C$, an $F$-structure on $B$, and a $G$-structure on $C$.
This definition is partially motivated by the following result on cycle indices:
\begin{theorem}\label{thm:specprodci}
  For species $F$ and $G$, the cycle index of their product is
  \begin{equation}
    \label{eq:specprodci}
    \ci{F \cdot G} = \ci{F} \cdot \ci{G}.
  \end{equation}
\end{theorem}

Conceptually, the species product can be used to describe species that decompose uniquely into substructures of two specified species.
For example, a permutation on a set $A$ decomposes uniquely into a (possibly empty) set of fixed points and a derangement of their complement in $A$.
Thus, $\specname{S} = \specname{E} \cdot \operatorname{Der}$ for $\specname{S}$ the species of partitions, $\specname{E}$ the species of sets, and $\operatorname{Der}$ the species of derangements.

We note also that species multiplication is commutative (up to species isomorphism) and distributes over addition, so the class of species with addition and multiplication forms a commutative semiring, with the species $\mathbf{1}: \begin{cases} \varnothing \mapsto \cbrac{\varnothing} \\ A \neq \varnothing \mapsto \varnothing \end{cases}$ as a multiplicative identity; if addition is completed as previously described, the class of virtual species with addition and multiplication forms a true commutative ring.

In addition, the question of which species can be decomposed as sums and products without resorting to virtual species is one of great interest; the notions of \emph{molecular} and \emph{atomic} species are directly derived from such decompositions, and represent the beginnings of the systematic study of the structure of the class of species as a whole.
Further details on this topic are presented in \cite[\S 2.6]{bll:species}.

\begin{definition}
  \label{def:speccomp}
  For two species $F$ and $G$ with $G \sbrac{\varnothing} = \varnothing$, define their \emph{composition} to be the species $F \circ G$ given by $\pbrac{F \circ G} \sbrac{A} = \prod_{\pi \in P \pbrac{A}} \pbrac{F \sbrac{\pi} \times \prod_{B \in \pi} G \sbrac{B}}$ where $P \pbrac{A}$ is the set of partitions of $A$.
\end{definition}
In other words, the composition $F \circ G$ produces the species of $F$-structures of collections of $G$-structures.
The requirement that $G \sbrac{\varnothing} = \varnothing$ --- that is, that there is no $G$-structure on an empty label set --- is essential.
If it is lifted, an arbitrary number of $G \sbrac{\varnothing}$-structures may be added arbitrarily to any $\pbrac{F \circ G}$-structure, rendering well-defined constructions impossible.
This definition is, again, motivated by a correspondence with a certain operation on cycle indices:
\begin{definition}
  \label{def:cipleth}
  Let $f$ and $g$ be cycle indices. Then the \emph{plethysm} $f \circ g$ is the cycle index
  \begin{equation}
    \label{eq:cipleth}
    f \circ g = f \sbrac{g \sbrac{p_{1}, p_{2}, p_{3}, \dots}, g \sbrac{p_{2}, p_{4}, p_{6}, \dots}, \dots},
  \end{equation}
  where $f \sbrac{a, b, \dots}$ denotes the cycle index $f$ with $a$ substituted for $p_{1}$, $b$ substituted for $p_{2}$, and so on.
\end{definition}
This definition is inherited directly from the theory of symmetric functions in infinitely many variables, where our $p_{i}$ are basis elements, as previously discussed. This operation on cycle indices then corresponds exactly to species composition:
\begin{theorem}
  \label{thm:speccompci}
  For species $F$ and $G$ with $G \sbrac{\varnothing} = \varnothing$, the cycle index of their plethysm is
  \begin{equation}
    \label{eq:speccompci}
    \ci{F \circ G} = \ci{F} \circ \ci{G}
  \end{equation}
  where $\circ$ in the right-hand side is as in equation \eqref{eq:cipleth}.
\end{theorem}
Many combinatorial structures admit natural descriptions as compositions of species.
For example, every graph admits a unique decomposition as a (possibly empty) set of (nonempty) connected graphs, so we have the species identity $\specname{G} = \specname{E} \circ \specname{G}^{C}$ for $\specname{G}$ the species of graphs and $\specname{G}^{C}$ the species of nonempty connected graphs.

Several other binary operations on species are defined in the literature, including the Cartesian product $F \times G$, the functorial composition $F \square G$, and the inner plethysm $F \boxtimes G$ of \cite{travis:inpleth}.
We will not use these here.
However, we do introduce two unary operations: $\pointed{F}$ and $F'$.

\begin{definition}
  \label{def:specderiv}
  For a species $F$, define its \emph{species derivative} to be the species $\deriv{F}$ given by $\deriv{F} \sbrac{A} = F \sbrac{A \cup \cbrac{*}}$ for $*$ an element chosen not in $A$ (say, the set $A$ itself).
\end{definition}
It is important to note that the label $*$ of an $\deriv{F}$-structure is \emph{distinguished} from the other labels; the automorphisms of the species $\deriv{F}$ cannot interchange $*$ with another label.
Thus, species differentiation is appropriate for cases where we want to remove one `position' in a structure.
For example, for $\specname{L}$ the species of linear orders and $\specname{C}$ the species of cyclic orders, we have $\specname{L} = \deriv{\specname{C}}$; a cyclic order on the set $A \cup \cbrac{*}$ is naturally associated with the linear order on the set $A$ produced by removing $*$.
Terming this operation `differentiation' is justified by its effect on cycle indices:
\begin{theorem}
  \label{thm:specderivci}
  For a species $F$, the cycle index of its derivative is given by
  \begin{equation}
    \label{eq:specderivci}
    \ci{\deriv{F}} \pbrac{p_{1}, p_{2}, \dots} = \pbrac{\frac{\partial}{\partial p_{1}} \ci{F}} \pbrac{p_{1}, p_{2}, \dots}.
  \end{equation}
\end{theorem}
We note that we cannot in general recover $\ci{F}$ from $\ci{\deriv{F}}$, since there may be terms in $\ci{F}$ which have no $p_{1}$-component (corresponding to $F$-structures which have no automorphisms with fixed points).

Finally, we introduce a variant of the species derivative which allows us to \emph{label} the distinguished element $*$:
\begin{definition}
  \label{def:specpoint}
  For a species $F$, define its \emph{pointed species} to be the species $\pointed{F}$ given by $\pointed{F} \sbrac{A} = F \sbrac{A} \times A$ (that is, pairs of the form $\pbrac{f, a}$ where $f$ is an $F$-structure on $A$ and $a \in A$) with transport $\pointed{F} \sbrac{\sigma} \pbrac{f, a} = \pbrac{F \sbrac{\sigma} \pbrac{f}, \sigma \pbrac{a}}$.
  We can also write $\pointed{F} \sbrac{A} = X \cdot \deriv{F}$ for $X$ the species of singletons.
\end{definition}
In other words, an $\pointed{F} \sbrac{A}$-structure is an $F \sbrac{A}$-structure with a distinguished element taken from the set $A$ (as opposed to $\deriv{F}$, where the distinguished element is new).
Thus, species pointing is appropriate for cases such as those of rooted trees: for $\mathfrak{a}$ the species of trees and $\specname{A}$ the species of rooted trees, we have $\specname{A} = \pointed{\mathfrak{a}}$.
Equation \eqref{eq:specderivci} leads directly to the following:
\begin{theorem}
  \label{thm:specpointci}
  For a species $F$, the cycle index of its corresponding pointed species is given by
  \begin{equation}
    \label{eq:specpointci}
    \ci{\pointed{F}} = \ci{X} \cdot \ci{\deriv{F}}.
  \end{equation}
\end{theorem}
Note that, again, we cannot in general recover $\ci{F}$ from $\ci{\pointed{F}}$, for the same reasons as in the case of $\ci{\deriv{F}}$.

\section{Multisort species}\label{s:mult}
A species $F$ as defined in \ref{def:species} is a functor $F: \catname{Bij} \to \catname{Set}$; an $F$-structure in $F \sbrac{A}$ takes its labels from the set $A$.
The tool-set so produced is adequate to describe many classes of combinatorial structures.
However, there is one particular structure type which it cannot effectively capture: the notion of distinct \emph{sorts} of elements within a structure.
Perhaps the most natural example of this is the case of $k$-colored graphs, where every vertex has one of $k$ colors with the requirement that no pair of adjacent vertices shares a color.
Automorphisms of such a graph must preserve the colorings of the vertices, which is not a natural restriction to impose in the calculation of the classical cycle index in equation \eqref{eq:cycinddef}.
We thus incorporate the notion of sorts directly into a new definition:
\begin{definition} 
  \label{def:multiset}
  For a fixed integer $k \geq 1$, define a \emph{$k$-multiset} to be an ordered $k$-tuple of sets.
  Say that a $k$-multiset is \emph{finite} if each component set is finite; in that case, its \emph{$k$-multicardinality} is the ordered tuple of its components' set cardinalities.
  Further, define a \emph{$k$-multifunction} to be an ordered $k$-tuple of set functions which acts componentwise on $k$-multisets.
  For two $k$-multisets $U$ and $V$, a $k$-multifunction $\sigma$ is a \emph{$k$-multibijection} if each component is a set bijection.
  For $k$-multisets of multicardinality $\pbrac{c_{1}, c_{2}, \dots, c_{k}}$, denote by $\symgp{c_{1}, c_{2}, \dots, c_{k}} = \symgp{c_{1}} \times \symgp{c_{2}} \times \dots \times \symgp{c_{k}}$ the \emph{$k$-sort symmetric group}, the elements of which are in natural bijection with $k$-multibijections from a $k$-multiset to itself.
  Finally, denote by $\catname{Bij}^{k}$ the category of finite $k$-multisets with $k$-multibijections.
\end{definition}

We can then define an extension of species to the context of multisets:
\begin{definition}
  \label{def:multisort}
  A \emph{$k$-sort species} $F$ is a functor $F: \catname{Bij}^{k} \to \catname{Bij}$ which associates to each $k$-multiset $U$ a set $F \sbrac{U}$ of \emph{$k$-sort $F$-structures} and to each bijective $k$-multifunction $\sigma: U \to V$ a bijection $F \sbrac{\sigma}: F \sbrac{U} \to F \sbrac{V}$.
\end{definition}
Functorality once again imposes naturality conditions on these associations.

Just as in the theory of ordinary species, to each multisort species is associated a power series, its \emph{cycle index}, which carries essential combinatorial data about the automorphism structure of the species.
To keep track of the multiple sorts of labels, however, we require multiple sets of indeterminates.
Where in ordinary cycle indices we simply used $p_{i}$ for the $i$th indeterminate, we now use $p_{i} \sbrac{j}$ for the $i$th indeterminate of the $j$th sort.
In some contexts with small $k$, we will denote our sorts with letters (saying, for example, that we have `$X$ labels' and `$Y$ labels'), in which case we will write $p_{i} \sbrac{x}$, $p_{i} \sbrac{y}$, and so forth.
In natural analogy to Definition \ref{def:cycind}, the formula for the cycle index of a $k$-sort species $F$ is given by
\begin{multline}
  \label{eq:multcycinddef}
  \ci{F} \sbrac{p_{1} \sbrac{1}, p_{2} \sbrac{1}, \dots; p_{1} \sbrac{2}, p_{2} \sbrac{2}, \dots; \dots; p_{1} \sbrac{k}, p_{2} \sbrac{k}, \dots} = \\
  \sum_{\substack{n \geq 0 \\ a_{1} + a_{2} + \dots + a_{k} = n}} \frac{1}{a_{1}! a_{2}! \dots a_{k}!} \sum_{\sigma \in \symgp{a_{1}, a_{2}, \dots, a_{k}}} \fix \pbrac{F \sbrac{\sigma}} p^{\sigma_{1}}_{\sbrac{1}} p^{\sigma_{2}}_{\sbrac{2}} \dots p^{\sigma_{k}}_{\sbrac{k}}.
\end{multline}
where by $p^{\sigma_{i}}_{\sbrac{i}}$ we denote the product $\prod_{j} \pbrac{p_{j} \sbrac{i}}^{\pbrac{\sigma_{i}}_{j}}$ where $\pbrac{\sigma_{i}}_{j}$ is the number of $j$-cycles of $\sigma_{i}$.

The operations of addition and multiplication extend to the multisort context naturally.
To make sense of differentiation and pointing, we need only specify a sort from which to draw the element or label which is marked; we then write $\deriv[X]{F}$ and $\pointed[X]{F}$ for the derivative and pointing respectively of $F$ `in the sort $X$', which is to say with its distinguished element drawn from that sort.
Making sense of the notion of composition in multisort species is highly context-dependent; we note here only that, when $F$ is a $1$-sort species and $G$ a $k$-sort species, the construction of the $k$-sort species $F \circ G$ is natural. 

\section{$\Gamma$-species and quotient species}\label{s:quot}
It is frequently the case that interesting combinatorial problems admit elegant descriptions in terms of quotients of a class of structure under the action of a group.
If we hope to integrate this concept into the theory of species, we must at least demand that the action of a group $\Gamma$ on a species $F$ be compatible with the transport of structures in the sense that transport of structures is equivariant under the $\Gamma$-action, or, equivalently, for which the actions of $\symgp{n}$ (on labels) and $\Gamma$ on all $F$-structures commute.
Informally, this is the requirement that $\Gamma$ acts on $F$-structures in a way that is independent of labelings.
We incorporate such transport-compatible actions into a new definition:
\begin{definition}
  \label{def:gspecies}
  For $\Gamma$ a group, a $\Gamma$-species $F$ is a species $F$ together with an action of $\Gamma$ on $F$-structures which commutes with transport of structures---that is, for which the whole diagram
  \begin{equation*}
    \begin{tikzpicture}[every node/.style={auto}]
      \matrix (m) [matrix of math nodes, row sep=4em, column sep=4em]
      {
        A & F \sbrac{A} & \gamma \cdot F \sbrac{A} \\
        B & F \sbrac{B}  & \gamma \cdot F \sbrac{B} \\
      };
      \path[->]
      (m-1-1) edge node[below] {$F$} (m-1-2)
      edge node {$\sigma$} (m-2-1)
      (m-1-2) edge node[below] {$\gamma$} (m-1-3)
      edge node {$F \sbrac{\sigma}$} (m-2-2)
      (m-1-3) edge node {$F \sbrac{\sigma}$} (m-2-3)
      (m-2-1) edge node {$F$} (m-2-2)
      (m-2-2) edge node {$\gamma$} (m-2-3);
    \end{tikzpicture}
  \end{equation*}
  commutes for every $\gamma \in \Gamma$.
  (Note that commutativity of the left square is required for $F$ to be a species at all.)
\end{definition}

For such a species, of course, it is then meaningful to pass to the quotient:
\begin{definition}
  \label{def:qspecies}
  For $F$ a $\Gamma$-species, define $\nicefrac{F}{\Gamma}$, the \emph{quotient species} of $F$ under the action of $\Gamma$, to be the species of $\Gamma$-orbits of $F$-structures.
\end{definition}

Simply because $\nicefrac{F}{\Gamma}$ is a species, we have transport of a bijection $\sigma: A \to B$ to a bijection $\nicefrac{F}{\Gamma} \sbrac{\sigma}: \nicefrac{F}{\Gamma} \sbrac{A} \to \nicefrac{F}{\Gamma} \sbrac{B}$. However, from the diagram above, we also have that
\begin{equation*}
  \begin{tikzpicture}[every node/.style={auto}]
    \matrix (m) [matrix of math nodes, row sep=4em, column sep=4em]
    {
      A & F \sbrac{A} & \nicefrac{F}{\Gamma} \sbrac{A} \\
      B & F \sbrac{B}  & \nicefrac{F}{\Gamma} \sbrac{B} \\
    };
    \path[->]
    (m-1-1) edge node[below] {$F$} (m-1-2)
    edge node {$\sigma$} (m-2-1)
    (m-1-2) edge node[below] {$\action{\Gamma}$} (m-1-3)
    edge node {$F \sbrac{\sigma}$} (m-2-2)
    (m-1-3) edge node {$\nicefrac{F}{\Gamma} \sbrac{\sigma}$} (m-2-3)
    (m-2-1) edge node {$F$} (m-2-2)
    (m-2-2) edge node {$\action{\Gamma}$} (m-2-3);
    
    \path[->,bend left]
    (m-1-1) edge node {$\nicefrac{F}{\Gamma}$} (m-1-3);

    \path[->,bend right]
    (m-2-1) edge node[below] {$\nicefrac{F}{\Gamma}$} (m-2-3);
    
\end{tikzpicture}
\end{equation*}
commutes.
Thus, the passage from $F$ to $\nicefrac{F}{\Gamma}$ is a natural transformation, given that we have defined the species $F$ as a functor $F: \catname{Bij} \to \catname{Set}$.
If instead we adopt the more common definition of a species as a functor $F: \catname{Bij} \to \catname{Bij}$, the maps denoted $\action{\Gamma}$ above are not in the target category $\catname{Bij}$, so passage to the $\Gamma$-quotient is no longer a natural transformation.

A brief exposition of the notion of quotient species may be found in \cite[\S 3.6]{bll:species}, and a more thorough exposition (in French) in \cite{bous:species}.
Our motivation, of course, is that combinatorial structures of a given class are often `naturally' identified with orbits of structures of another, larger class under the action of some group.
Our goal will be to compute the cycle index of the species $\nicefrac{F}{\Gamma}$ in terms of that of $F$ and information about the $\Gamma$-action, so that enumerative data about the quotient species can be extracted.

As an intermediate step to the computation of the cycle index associated to this quotient species, we associate a cycle index to a $\Gamma$-species $F$ that keeps track of the needed data about the $\Gamma$-action.
\begin{definition}
  \label{def:gcycind}
  For a $\Gamma$-species $F$, define the $\Gamma$-cycle index $\gci{\Gamma}{F}$ as in \cite{hend:specfield}: for each $\gamma \in \Gamma$, let
  \begin{equation}
    \gci{\Gamma}{F} \pbrac{\gamma} = \sum_{n \geq 0} \frac{1}{n!} \sum_{\sigma \in \symgp{n}} \fix \pbrac{\gamma \cdot F \sbrac{\sigma}} p_{\sigma} \label{eq:gcycinddef}
  \end{equation}
  with $p_{\sigma}$ as in equation \eqref{eq:cycinddef}.
\end{definition}

We will call such an object (formally a map from $\Gamma$ to the ring $\mathbf{Q} \sbrac{\sbrac{p_{1}, p_{2}, \dots}}$ of symmetric functions with rational coefficients in the $p$-basis) a \emph{$\Gamma$-cycle index} even when it is not explicitly the $\Gamma$-cycle index of a $\Gamma$-species, and we will sometimes call $\gci{\Gamma}{F} \pbrac{\gamma}$ the `$\gamma$ term of $\gci{\Gamma}{F}$'.
So the coefficients in the power series count the fixed points of the \emph{combined} action of a permutation and the group element $\gamma$.
Note that, in particular, the classical (`ordinary') cycle index may be recovered as $\ci{F} = \gci{\Gamma}{F} \pbrac{e}$ for any $\Gamma$-species $F$.

The algebraic relationships between ordinary species and their cycle indices generally extend without modification to the $\Gamma$-species context, as long as appropriate allowances are made.
The actions on cycle indices of $\Gamma$-species addition and multiplication are exactly as in the ordinary species case considered componentwise:
\begin{definition}
  \label{def:gspecsumprod}
  For two $\Gamma$-species $F$ and $G$, the $\Gamma$-cycle index of their sum $F + G$ is given by
  \begin{equation}
    \label{eq:gspecsum}
    \gci{\Gamma}{F + G} \pbrac{\gamma} = \gci{\Gamma}{F} \pbrac{\gamma} + \gci{\Gamma}{G} \pbrac{\gamma}
  \end{equation}
  and the $\Gamma$-cycle index of their product $F \cdot G$ is given by
  \begin{equation}
    \label{eq:gspecprod}
    \gci{\Gamma}{F \cdot G} \pbrac{\gamma} = \gci{\Gamma}{F} \pbrac{\gamma} \cdot \gci{\Gamma}{G} \pbrac{\gamma}
  \end{equation}
\end{definition}
The action of composition, which in ordinary species corresponds to plethysm of cycle indices, can also be extended:
\begin{definition}
  \label{def:gspeccomp}
  For two $\Gamma$-species $F$ and $G$, define their \emph{composition} to be the $\Gamma$-species $F \circ G$ with structures given by $\pbrac{F \circ G} \sbrac{A} = \prod_{\pi \in P \pbrac{A}} \pbrac{F \sbrac{\pi} \times \prod_{B \in \pi} G \sbrac{B}}$ where $P \pbrac{A}$ is the set of partitions of $A$ and where $\gamma \in \Gamma$ acts on a $\pbrac{F \circ G}$-structure by acting on the $F$-structure and the $G$-structures independently.
\end{definition}
The requirement in Definition \ref{def:gspecies} that the action of $\Gamma$ commutes with transport implies that this is well-defined.
Informally, for $\Gamma$-species $F$ and $G$, we have defined the composition $F \circ G$ to be the $\Gamma$-species of $F$-structures of $G$-structures, where $\gamma \in \Gamma$ acts on an $\pbrac{F \circ G}$-structure by acting independently on the $F$-structure and each of its associated $G$-structures.
A formula similar to that Theorem \ref{thm:speccompci} requires a definition of the plethysm of $\Gamma$-symmetric functions, here taken from \cite[\S 3]{hend:specfield}:
\begin{definition}
  \label{def:gcipleth}
  For two $\Gamma$-cycle indices $f$ and $g$, their \emph{plethysm} $f \circ g$ is a $\Gamma$-cycle index defined by
  \begin{equation}
    \pbrac{f \circ g} \pbrac{\gamma} = f \pbrac{\gamma} \sbrac{g \pbrac{\gamma} \sbrac{p_{1}, p_{2}, p_{3}, \dots}, g \pbrac{\gamma^{2}} \sbrac{p_{2}, p_{4}, p_{6}, \dots}, \dots}.
    \label{eq:gcipleth}
  \end{equation}
\end{definition}
This definition of $\Gamma$-cycle index plethysm is then indeed the correct operation to pair with the composition of $\Gamma$-species:
\begin{theorem}[Theorem 3.1, \cite{hend:specfield}]
  \label{thm:gspeccompci}
  If $A$ and $B$ are $\Gamma$-species and $B \pbrac{\varnothing} = \varnothing$, then
  \begin{equation}
    \label{eq:gspeccompci}
    \gci{\Gamma}{A \circ B} = \gci{\Gamma}{A} \circ \gci{\Gamma}{B}.
  \end{equation}
\end{theorem}
Thus, $\Gamma$-species admit the same sorts of `nice' correspondences between structural descriptions (in terms of functorial algebra) and enumerative characterizations (in terms of cycle indices) that ordinary species do.

However, to make use of this theory for enumerative purposes, we also need to be able to pass from the $\Gamma$-cycle index of a $\Gamma$-species to the ordinary cycle index of its associated quotient species under the action of $\Gamma$.
This will allow us to adopt a useful strategy: if we can characterize some difficult-to-enumerate combinatorial structure as quotients of more accessible structures, we will be able to apply the full force of species theory to the enumeration of the prequotient structures, \emph{then} pass to the quotient when it is convenient.
Exactly this approach will serve as the core of both of the following chapters.

Since we intend to enumerate orbits under a group action, we apply a generalization of Burnside's Lemma found in \cite[Lemma 5]{gessel:laginvspec}:
\begin{lemma}
  \label{lem:grouporbits}
  If $\Gamma$ and $\Delta$ are finite groups and $S$ a set with a $\pbrac{\Gamma \times \Delta}$-action, for any $\delta \in \Delta$ the number of $\Gamma$-orbits fixed by $\delta$ is $\frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} \fix \pbrac{\gamma, \delta}$.
\end{lemma}

Recall from equation \eqref{eq:cycinddef} that, to compute the cycle index of a species, we need to enumerate the fixed points of each $\sigma \in \symgp{n}$.
However, to do this in the quotient species $\nicefrac{F}{\Gamma}$ is by definition to count the fixed $\Gamma$-orbits of $\sigma$ in $F$ under commuting actions of $\symgp{n}$ and $\Gamma$ (that is, under an $\pbrac{\symgp{n} \times \Gamma}$-action).
Thus, Lemma \ref{lem:grouporbits} implies the following:
\begin{theorem}\label{thm:qsci}
  For a $\Gamma$-species $F$, the ordinary cycle index of the quotient species $\nicefrac{F}{\Gamma}$ is given by 
  \begin{equation}
    \label{eq:quotcycind}
    \ci{F / \Gamma} = \qgci{\Gamma}{F} \defeq \frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} \gci{\Gamma}{F} \pbrac{\gamma} = \frac{1}{\abs{\Gamma}} \sum_{\substack{n \geq 0 \\ \sigma \in \symgp{n} \\ \gamma \in \Gamma}} \frac{1}{n!} \pbrac{\gamma \cdot F \sbrac{\sigma}} p_{\sigma}.
  \end{equation}
  where we define $\qgci{\Gamma}{F} = \frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} \gci{\Gamma}{F} \pbrac{\gamma}$ for future convenience.
\end{theorem}
Note that this same result on cycle indices is implicit in \cite[\S 2.2.3]{bous:species}.
With it, we can compute explicit enumerative data for a quotient species using cycle-index information of the original $\Gamma$-species with respect to the group action, as desired.

Recall from Theorems \ref{thm:ciegf} and \ref{thm:ciogf} that the exponential generating function $F \pbrac{x}$ of labeled $F$-structures and the ordinary generating function $\tilde{F} \pbrac{x}$ of unlabeled $F$-structures may both be computed from the cycle index $\ci{F}$ of an ordinary species $F$ by simple substitutions.
In the $\Gamma$-species context, we may perform similar substitutions to derive analogous generating functions.

\begin{theorem}
  \label{thm:gciegf}
  The exponential generating function $F_{\gamma} \pbrac{x}$ of labeled $\gamma$-invariant $F$-structures is
  \begin{equation}
    \label{eq:gciegf}
    F_{\gamma} \pbrac{x} = \gci{\Gamma}{F} \pbrac{\gamma} \sbrac{x, 0, 0, \dots}.
  \end{equation}
\end{theorem}

\begin{theorem}
  \label{thm:gciogf}
  The ordinary generating function $\tilde{F}_{\gamma} \pbrac{x}$ of unlabeled $\gamma$-invariant $F$-structures is
  \begin{equation}
    \label{eq:gciogf}
    \tilde{F}_{\gamma} \pbrac{x} = \gci{\Gamma}{F} \pbrac{\gamma} \sbrac{x, x^{2}, x^{3}, \dots}.
  \end{equation}
\end{theorem}
Note that the notion of `unlabeled $\gamma$-invariant $F$-structures' is always well-defined precisely because Definition \ref{def:gspecies} requires that the action of $\Gamma$ commutes with transport of structures.

From these results and Theorem \ref{thm:qsci}, we can the conclude:
\begin{theorem}
  \label{qgciegf}
  The exponential generating function $F \pbrac{x}$ of labeled $\nicefrac{F}{\Gamma}$-structures is
  \begin{equation}
    \label{eq:qgciegf}
    F \pbrac{x} = \frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} F_{\gamma} \pbrac{x}.
  \end{equation}
\end{theorem}

Similarly,
\begin{theorem}
  \label{qgciogf}
  The ordinary generating function $\tilde{F} \pbrac{x}$ of unlabeled $\nicefrac{F}{\Gamma}$-structures is
  \begin{equation}
    \label{eq:qgcogf}
    \tilde{F} \pbrac{x} = \frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} \tilde{F}_{\gamma} \pbrac{x}.
  \end{equation}
\end{theorem}

These results also follow directly from Burnside's Lemma.

Note also that all of the above extends naturally into the multisort species context.
We will use this extensively in Chapter \ref{c:ktrees}.
It also extends naturally to weighted contexts, but we will not apply this extension here.

\chapter{The species of bipartite blocks}\label{c:bpblocks}
\section{Introduction}\label{s:bpintro}
We first apply the theory of quotient species to the enumeration of bipartite blocks.

\begin{definition}
  \label{def:bcgraph}
  A \emph{bicolored graph} is a graph $\Gamma$ each vertex of which has been assigned one of two colors (here, black and white) such that each edge connects vertices of different colors.
  A \emph{bipartite graph} (sometimes called \emph{bicolorable}) is a graph $\Gamma$ which admits such a coloring.  
\end{definition}

There is an extensive literature about bicolored and bipartite graphs, including enumerative results for bicolored graphs \cite{har:bicolored}, bipartite graphs both allowing \cite{han:bipartite} and prohibiting \cite{harprins:bipartite} isolated points, and bipartite blocks \cite{harrob:bipblocks}.
However, this final enumeration was previously completed only in the labeled case.
By considering the problem in light of the theory of $\Gamma$-species, we develop a more systematic understanding of the structural relationships between these various classes of graphs, which allows us to enumerate all of them in both labeled and unlabeled settings.

Throughout this chapter, we denote by $\specname{BC}$ the species of bicolored graphs and by $\specname{BP}$ the species of bipartite graphs.
The prefix $\specname{C}$ will indicate the connected analogue of such a species.

The motivating graph-theoretic observation is that each \emph{connected} bipartite graph may be identified with exactly two bicolored graphs which are color-dual; in other words, a connected bipartite graph is (by definition or by easy exercise, depending on your approach) an orbit of connected bicolored graphs under the action of $\symgp{2}$ where the nontrivial element $\tau$ reverses all vertex colors.
We will hereafter treat all the various species of bicolored graphs as $\symgp{2}$-species with respect to this action and use the theory developed in \S \ref{s:quot} to pass to bipartite graphs.

Although the theory of multisort species presented in \S \ref{s:mult} is in general well-suited to the study of colored graphs, we will not need it here.
The restrictions that vertex colorings place on automorphisms of bicolored graphs are simple enough that we can deal with them directly.

\section{Bicolored graphs}\label{s:bcgraph}
TODO: Say more about importance and nuance of $F_{0}$ either here or in chapter 1.
We begin our investigation by directly computing the $\symgp{2}$-cycle index for the species $\specname{BC}$ of bicolored graphs with the color-reversing $\symgp{2}$-action described previously.
We will then use various methods from the species algebra of \S \ref{c:species} to pass to various other species.

\subsection{Computing $\gci{\symgp{2}}{\specname{BC}} \pbrac{e}$}\label{ss:ecibc}
We construct the cycle index for the species $\specname{BC}$ of bicolored graphs in the classical way, which in light of our $\symgp{2}$-action will give $\gci{\symgp{2}}{\specname{BC}} \pbrac{e}$. 

Recall the formula for the cycle index of a $\Gamma$-species in equation \eqref{eq:gcycinddef}:
\begin{equation*}
  \gci{\Gamma}{F} \pbrac{\gamma} = \sum_{n \geq 0} \frac{1}{n!} \sum_{\sigma \in \symgp{n}} \fix \pbrac{\gamma \cdot F \sbrac{\sigma}} p_{\sigma}.
\end{equation*}
Thus, for each $n > 0$ and each permutation $\pi \in \symgp{n}$, we must count bicolored graphs on $\sbrac{n}$ for which $\pi$ is a color-preserving automorphism.
To simplify some future calculations, we omit empty graphs and define $\specname{BC} \sbrac{\varnothing} = \varnothing$.
We note that the \emph{number} of such graphs in fact depends only on the cycle type $\lambda \vdash n$ of the permutation $\pi$, so we can use the cycle index formula in equation \eqref{eq:cycinddefpart} interpreted as a $\Gamma$-cycle index identity.

Fix some $n \geq 0$ and let $\lambda \vdash n$.
We wish to count bicolored graphs for which a chosen permutation $\pi$ of cycle type $\lambda$ is a color-preserving automorphism.
Each cycle of the permutation must correspond to a monochromatic subset of the vertices, so we may construct graphs by drawing bicolored edges into a given colored vertex set.
If we draw some particular bicolored edge, we must also draw every other edge in its orbit under $\pi$ if $\pi$ is to be an automorphism of the graph.
Moreover, every bicolored graph for which $\pi$ is an automorphism may be constructed in this way
Therefore, we direct our attention first to counting these edge orbits for a fixed coloring; we will then count colorings with respect to these results to get our total cycle index.

Consider an edge connecting two cycles of lengths $m$ and $n$; the length of its orbit under the permutation is $\lcm \pbrac{m, n}$, so the number of such orbits of edges between these two cycles is $mn / \lcm \pbrac{m, n} = \gcd \pbrac{m, n}$.
For an example in the case $m = 4, n = 2$, see Figure \ref{fig:exbcecycle}.
The number of orbits for a fixed coloring is then $\sum \gcd \pbrac{m, n}$ where the sum is over the multiset of all cycle lengths $m$ of white cycles and $n$ of black cycles in the permutation $\pi$.
We may then construct any possible graph fixed by our permutation by making a choice of a subset of these cycles to fill with edges, so the total number of such graphs is $\prod 2^{\gcd \pbrac{m, n}}$ for a fixed coloring.

\begin{figure}[htb]
  \centering

  \begin{tikzpicture}
    % \SetGraphUnit{2}
    \GraphInit[vstyle=Hasse]
    
    \begin{scope}[xshift=-3cm,rotate=30]
      \SetUpEdge[style=cycedge]
      \grCycle[RA=2,prefix=a]{4}
    \end{scope}

    \begin{scope}[xshift=+3cm,rotate=90]
      \SetUpEdge[style=cycedge]
      \grCycle[RA=2,prefix=b]{2}
      \AddVertexColor{black!20}{b0,b1}
    \end{scope}

    \SetUpEdge[style=dashed]
    \EdgeDoubleMod{a}{4}{0}{1}{b}{2}{0}{1}{4}
    
    \SetUpEdge[style=solid]
    \Edge[label={$e$}](a1)(b1)
  \end{tikzpicture}
  \caption[Example edge-orbit of a color-preserving automorphism]{An edge $e$ (solid) between two cycles of lengths $4$ and $2$ in a permutation and that edge's orbit (dashed)}
  \label{fig:exbcecycle}
\end{figure}

We now turn our attention to the possible colorings of the graph which are compatible with a permutation of specified cycle type $\lambda$.
We split our partition into two subpartitions, writing $\lambda = \mu \cup \nu$, where partitions are treated as multisets and $\cup$ is the multiset union, and designate $\mu$ to represent the white cycles and $\nu$ the black.
Then the total number of graphs fixed by such a permutation with a specified decomposition is
\begin{equation*}
  \fix \pbrac{\mu, \nu} = \prod_{\substack{i \in \mu \\ j \in \nu}} 2^{\gcd \pbrac{i, j}}
\end{equation*}
where the product is over the elements of $\mu$ and $\lambda$ taken as multisets.
However, since $\mu$ and $\nu$ represent white and black cycles respectively, it is important to distinguish \emph{which} cycles of $\lambda$ are taken into each.
The $\lambda_{i}$ $i$-cycles of $\lambda$ can be distributed into $\mu$ and $\nu$ in $\binom{\lambda_{i}}{\mu_{i}} = \lambda_{i}! / \pbrac{\mu_{i}! \nu_{i}!}$ ways, so in total there are $\prod_{i} \lambda_{i}! / \pbrac{\mu_{i}! \nu_{i}!} = z_{\lambda} / \pbrac{z_{\mu} z_{\nu}}$ decompositions.
Thus,
\begin{equation*}
  \fix \pbrac{\lambda} = \frac{z_{\lambda}}{z_{\mu} z_{\nu}} \fix \pbrac{\mu, \nu} = \sum_{\mu \cup \nu = \lambda} \frac{z_{\lambda}}{z_{\mu} z_{\nu}} \prod_{\substack{i \in \mu \\ j \in \nu}} 2^{\gcd \pbrac{i, j}}.
\end{equation*}
Therefore we conclude:
\begin{theorem}
  \begin{equation}
    \label{eq:ecibc}
    \gci{\symgp{2}}{\specname{BC}} \pbrac{e} = \sum_{n > 0} \sum_{\substack{\mu, \nu \\ \mu \cup \nu \vdash n}} \frac{p_{\mu \cup \nu}}{z_{\mu} z_{\nu}} \prod_{i, j} 2^{\gcd \pbrac{\mu_{i}, \nu_{j}}}
  \end{equation}
\end{theorem}

Explicit formulas for the generating function for unlabeled bicolored graphs were obtained in \cite{har:bicolored} using conventional P\'{o}lya-theoretic methods.
Conceptually, this enumeration in fact largely mirrors our own.
Harary uses the algebra of the classical cycle index of the `line group\footnote{The \emph{line group} of a graph is the group of permutations of edges induced by permutations of vertices.}' of the complete bicolored graph of which any given bicolored graph is a spanning subgraph.
He then enumerates orbits of edges under these groups using the P\'{o}lya enumeration theorem.
This is clearly analogous to our procedure, which enumerates the orbits of edges under each specific permutation of vertices.
The numbers of labeled and unlabeled bicolored graphs for $n \leq 10$ as calculated using our method are given in Table \ref{tab:bc} and agree with those previous results.

\subsection{Calculating $\gci{\symgp{2}}{\specname{BC}} \pbrac{\tau}$}\label{ss:tcibc}
Recall that the nontrivial element of $\tau \in \symgp{2}$ acts on bicolored graphs by reversing all colors.

We again consider the cycles in the vertex set $\sbrac{n}$ induced by a permutation $\pi \in \symgp{n}$ and use the partition $\lambda$ corresponding to the cycle type of $\pi$ for bookkeeping.
We then wish to count bicolored graphs on $\sbrac{n}$ for which $\tau \cdot \pi$ is an automorphism, which is to say that $\pi$ itself is a color-\emph{reversing} automorphism.
Once again, the number of bicolored graphs for which $\pi$ is a color-reversing automorphism is in fact dependent only on the cycle type $\lambda$.
Each cycle of vertices must be color-alternating and hence of even length, so our partition $\lambda$ must have only even parts.
Once this condition is satisfied, edges may be drawn either within a single cycle or between two cycles, and as before if we draw in any edge we must draw in its entire orbit under $\pi$ (since $\pi$ is to be an automorphism of the underlying graph).
Moreover, all graphs for which $\pi$ is a color-reversing automorphism and with a fixed coloring may be constructed in this way, so it suffices to count such edge orbits and then consider how colorings may be assigned.

Consider a cycle of length $2n$; we hereafter describe such a cycle as having \emph{semilength} $n$.
There are exactly $n^{2}$ possible white-black edges in such a cycle.
If $n$ is odd, diametrically opposed vertices have opposite colors, so we can have an edge of length $l = n$ (in the sense of connecting two vertices which are $l$ steps apart in the cycle), and in such a case the orbit length is exactly $n$ and there is exactly one orbit.
See Figure \ref{fig:exbctincycd} for an example of this case.
However, if $n$ is odd but $l \neq n$, the orbit length is $2n$, so the number of such orbits is $\frac{n^{2} - n}{2n}$.
Hence, the total number of orbits for $n$ odd is $\frac{n^2 + n}{2n} = \ceil{\frac{n}{2}}$.
Similarly, if $n$ is even, all orbits are of length $2n$, so the total number of orbits is $\frac{n^{2}}{2n} = \frac{n}{2} = \ceil{\frac{n}{2}}$ also.
See Figure \ref{fig:exbctincyce} for an example of each of these cases.

\begin{figure}[htb]
  \centering
  \subfloat[A diameter $d$ ($l = 3$)]{\makebox[.45\textwidth]{
      \label{fig:exbctincycd}
      \begin{tikzpicture}
        % \SetGraphUnit{2}
        \GraphInit[vstyle=Hasse]
        
        \SetUpEdge[style=cycedge]
        \grCycle[RA=2,prefix=a]{6}
        \AddVertexColor{black!20}{a0,a2,a4}

        \SetUpEdge[style=dashed]
        \EdgeInGraphMod{a}{6}{3}{0}

        \SetUpEdge[style=solid]
        \Edge[label={$d$},style={pos=.25}](a0)(a3)
      \end{tikzpicture}
    }}
  \hfill
  \subfloat[A non-diameter $e$ ($l = 1)$]{\makebox[.45\textwidth]{
      \label{fig:exbctincyce}
      \begin{tikzpicture}
        % \SetGraphUnit{2}
        \GraphInit[vstyle=Hasse]
        \SetUpEdge[style=cycedge]
        \grCycle[RA=2,prefix=b]{6}
        \AddVertexColor{black!20}{b0,b2,b4}

        \SetUpEdge[style=dashed]
        \EdgeInGraphMod{b}{6}{1}{0}

        \SetUpEdge[style=solid]
        \Edge[label={$e$}](b0)(b1)
      \end{tikzpicture}
    }}
  \caption[Two example edge-orbits in a color-reversing automorphism]{Both types of intra-cycle edges and their orbits on a typical color-alternating $6$-cycle}
  \label{fig:exbctincyc}
\end{figure}

Now consider an edge to be drawn between two cycles of semilengths $m$ and $n$.
The total number of possible white-black edges is $2mn$, each of which has an orbit length of $\lcm \pbrac{2m, 2n} = 2 \lcm \pbrac{m, n}$.
Hence, the total number of orbits is $2mn / \pbrac{2 \lcm \pbrac{m, n}} = \gcd \pbrac{m, n}$.

\begin{figure}[htb]
  \centering
  \begin{tikzpicture}
    \GraphInit[vstyle=Hasse]
    
    \begin{scope}[xshift=-4cm,rotate=30]
      \SetUpEdge[style=cycedge]
      \grCycle[RA=2,prefix=a]{4}
      \AddVertexColor{black!20}{a0,a2}
    \end{scope}

    \begin{scope}[xshift=4cm,rotate=90]
      \SetUpEdge[style=cycedge]
      \grCycle[RA=2,prefix=b]{2}
      \AddVertexColor{black!20}{b0}
    \end{scope}

    \SetUpEdge[style=dashed]
    \EdgeDoubleMod{a}{4}{1}{1}{b}{2}{0}{1}{4}

    \SetUpEdge[style=solid]
    \Edge[label={$e$}](a0)(b1)
  \end{tikzpicture}
  \caption[Another example edge-orbit of a color-reversing automorphism]{An edge $e$ and its orbit between color-alternating cycles of semilengths $2$ and $1$}
  \label{fig:exbctbtwcyc}
\end{figure}

All together, then, the number of orbits for a fixed coloring of a permutation of cycle type $2 \lambda$ (denoting the partition obtained by doubling every part of $\lambda$) is $\sum_{i} \ceil{\frac{\lambda_{i}}{2}} + \sum_{i < j} \gcd \pbrac{\lambda_{i}, \lambda_{j}}$.
All valid bicolored graphs for a fixed coloring for which $\pi$ is a color-preserving automorphism may be obtained uniquely by making some choice of a subset of this collection of orbits, just as in \S \ref{ss:ecibc}.
Thus, the total number of possible graphs for a given vertex coloring is
\begin{equation*}
  \prod_{i} 2^{\ceil{\frac{\lambda_{i}}{2}}} \prod_{i < j} 2^{\gcd \pbrac{\lambda_{i}, \lambda_{j}}},
\end{equation*}
which we note is independent of the choice of coloring.
For a partition $2\lambda$ with $l \pbrac{\lambda}$ cycles, there are then $2^{l \pbrac{\lambda}}$ colorings compatible with our requirement that each cycle is color-alternating, which we multiply by the previous to obtain the total number of graphs for all permutations $\pi$ with cycle type $2 \lambda$.
Therefore we conclude:
\begin{theorem}
  \begin{equation}
    \label{eq:tcibc}
    \gci{\symgp{2}}{\specname{BC}} \pbrac{\tau} = \sum_{\substack{n > 0 \\ \text{$n$ even}}} \sum_{\lambda \vdash \frac{n}{2}} 2^{l \pbrac{\lambda}} \frac{p_{2 \lambda}}{z_{2 \lambda}} \prod_{i} 2^{\ceil{\frac{\lambda_{i}}{2}}} \prod_{i < j} 2^{\gcd \pbrac{\lambda_{i}, \lambda_{j}}}
  \end{equation}
\end{theorem}

\section{Connected bicolored graphs}\label{s:cbc}
As noted in the introduction of this section, we may pass from bicolored to bipartite graphs by taking a quotient under the color-reversing action of $\symgp{2}$ only in the connected case.
Thus, we must pass from the species $\specname{BC}$ to the species $\specname{CBC}$ of connected bicolored graphs to continue.
It is a standard principle of graph enumeration that a graph may be decomposed uniquely into (and thus species-theoretically identified with) the set of its connected components.
We must, of course, require that the component structures are nonempty to ensure well-definedness, as discussed in \S \ref{s:specalg}.
This same relationship holds in the case of bicolored graphs.
Thus, the species $\specname{BC}$ of nonempty bicolored graphs is the composition of the species $\specname{CBC}$ of nonempty connected bicolored graphs into the species $\specname{E}^{+} = \specname{E} - 1$ of nonempty sets:
\begin{equation} \specname{BC} = \specname{E}^{+} \circ \specname{CBC} \label{eq:bcdecomp} \end{equation}

Reversing the colors of a bicolored graph is done simply by reversing the colors of each of its connected components independently; thus, once we trivially extend the species $\specname{E}^{+}$ to an $\symgp{2}$-species by applying the trivial action, equation \eqref{eq:bcdecomp} holds as an identity of $\symgp{2}$-species for the color-reversing $\symgp{2}$-action described previously.

To use the decomposition in equation \eqref{eq:bcdecomp} to derive the $\symgp{2}$-cycle index for $\specname{CBC}$, we must invert the $\symgp{2}$-species composition into $\specname{E}^{+}$.
In the context of the theory of virtual species, this is possible; we write $\con := \pbrac{\specname{E} - 1}^{\abrac{-1}}$ to denote this virtual species.
We can derive from \cite[\S 2.5, eq.~(58c)]{bll:species} that its cycle index is
\begin{equation}
  \label{eq:zgamma}
  \ci{\con} = \sum_{k \geq 1} \frac{\mu \pbrac{k}}{k} \log \pbrac{1 + p_{k}}
\end{equation}
where $\mu$ is the M\"{o}bius function.
We can then rewrite equation \eqref{eq:bcdecomp} as
\[\specname{CBC} = \con \circ \specname{BC}\]
It then follows immediately from Theorem \ref{thm:gspeccompci} that
\begin{theorem}
  \begin{equation} \gci{\symgp{2}}{\specname{CBC}} = \ci{\con} \circ \gci{\symgp{2}}{\specname{BC}} \label{eq:zcbcdecomp} \end{equation}
\end{theorem}

The numbers of labeled and unlabeled connected bicolored graphs for $n \leq 10$ as calculated using our method are given in Table \ref{tab:cbc}.

\section{Bipartite graphs}\label{s:bp}
As we previously observed, connected bipartite graphs are naturally identified with orbits of connected bicolored graphs under the color-reversing action of $\symgp{2}$.
Thus,
\begin{equation*}
  \specname{CBP} = \faktor{\specname{CBC}}{\symgp{2}}.
\end{equation*}
By application of Theorem \ref{thm:qsci}, we can then directly compute the cycle index of $\specname{CBP}$ in terms of previous results:
\begin{theorem}
  \begin{equation}
    \ci{\specname{CBP}} = \qgci{\symgp{2}}{\specname{CBC}} = \frac{1}{2} \pbrac{\gci{\symgp{2}}{\specname{CBC}} \pbrac{e} + \gci{\symgp{2}}{\specname{CBC}} \pbrac{\tau}}.
  \end{equation}
\end{theorem}

Finally, to reach a result for the general bipartite case, we return to the graph-theoretic composition relationship previously considered in \S \ref{s:cbc}:
\begin{equation*}
  \specname{BP} = \specname{E} \circ \specname{CBP}.
\end{equation*}

This time, we need not invert the composition, so the cycle-index calculation is simple:
\begin{theorem}
  \begin{equation}
    \ci{\specname{BP}} = \ci{\specname{E}} \circ \ci{\specname{CBP}}.
  \end{equation}
\end{theorem}

A generating function for labeled bipartite graphs was obtained first in \cite{harprins:bipartite} and later in \cite{han:bipartite}; the latter uses P\'{o}lya-theoretic methods to calculate the cycle index of what in modern terminology would be the species of edge-labeled complete bipartite graphs.
The numbers of labeled and unlabeled bipartite graphs for $n \leq 10$ as calculated using our method are given in Table \ref{tab:bp}.

\section{Nonseparable graphs}\label{s:nbp}
We now turn our attention to the notions of block decomposition and nonseparable graphs.
A graph is said to be \emph{nonseparable} if it is $2$-connected (that is, if there exists no point whose removal disconnects the graph); every connected graph then has a canonical `decomposition'\footnote{Note that this decomposition does not actually partition the vertices, since many blocks may share a single cut-point, a detail which significantly complicates but does not entirely preclude species-theoretic analysis.} into maximal nonseparable subgraphs, often shortened to \emph{blocks}.
In the spirit of our previous notation, we we will denote by $\specname{NBP}$ the species of nonseparable bipartite graphs, our object of study.

The basic principles of block enumeration in terms of automorphisms and cycle indices of permutation groups were first identified and exploited in \cite{rob:nonsep}.
In \cite[\S 4.2]{bll:species}, a theory relating a specified species $B$ of nonseparable graphs to the species $C_{B}$ of connected graphs whose blocks are in $B$ is developed using similar principles.
It is apparent that the class of nonseparable bipartite graphs is itself exactly the class of blocks that occur in block decompositions of connected bipartite graphs; hence, we apply that theory here to study the species $\specname{NBP}$.
From \cite[eq.~4.2.27]{bll:species} we obtain
\begin{theorem}
  \begin{subequations}
    \label{eq:nbpexp}
    \begin{equation}
      \label{eq:nbpexpmain}
      \specname{NBP} = \specname{CBP} \pbrac{\specname{CBP}^{\bullet \abrac{-1}}} + X \cdot \deriv{\specname{NBP}} - X,
    \end{equation}
    where by \cite[4.2.26(a)]{bll:species} we have
    \begin{equation}
      \label{eq:nbpexpsub}
      \deriv{\specname{NBP}} = \con \pbrac{\frac{X}{\specname{CBP}^{\bullet \abrac{-1}}}}.
    \end{equation}
  \end{subequations}

\end{theorem}
We have already calculated the cycle index for the species $\specname{CBP}$, so the calculation of the cycle index of $\specname{NBP}$ is now simply a matter of algebraic expansion.

A generating function for labeled bipartite blocks was given in \cite{harrob:bipblocks}, where their analogue of equation \eqref{eq:nbpexp} for the labeled exponential generating function for blocks comes from \cite{forduhl:combprob1}.
However, we could locate no corresponding unlabeled enumeration in the literature.
The numbers of labeled and unlabeled nonseparable bipartite graphs for $n \leq 10$ as calculated using our method are given in Table \ref{tab:nbp}.

\chapter{The species of $k$-trees}\label{c:ktrees}
\section{Introduction}\label{s:intro}
\subsection{$k$-trees}\label{ss:ktrees}
Trees and their generalizations have the literature of combinatorial graph theory throughout its history.
The multi-dimensional generalization to so-called `$k$-trees' has proved to be particularly fertile ground for both research problems and applications.

The class $\mathfrak{a}_{k}$ of $k$-trees (for $k \in \mathbf{N}$) may be defined recursively:
\begin{definition}
  \label{def:ktree}
  The complete graph on $k$ vertices ($K_{k}$) is a $k$-tree, and any graph formed by adding a single vertex to a $k$-tree and connecting that vertex by edges to some existing $k$-clique (that is, induced $k$-complete subgraph) of that $k$-tree is a $k$-tree.
\end{definition}

The graph-theoretic notion of $k$-trees was first introduced in 1968 in \cite{harpalm:acycsimp}; vertex-labeled $k$-trees were quickly enumerated in the following year in both \cite{moon:lktrees} and \cite{beinpipp:lktrees}.
The special case $k=2$ has been especially thoroughly studied; enumerations are available in the literature for edge- and triangle-labeled $2$-trees in \cite{palm:l2trees}, for plane $2$-trees in \cite{palmread:p2trees}, and for unlabeled $2$-trees in \cite{harpalm:acycsimp} and \cite{harpalm:graphenum}.
In 2001, the theory of species was brought to bear on $2$-trees in \cite{gessel:spec2trees}, resulting in more explicit formulas for the enumeration of unlabeled $2$-trees.
An extensive literature on other properties of $k$-trees and their applications has also emerged; Beineke and Pippert claim in \cite{beinpipp:multidim} that ``[t]here are now over 100 papers on various aspects of $k$-trees''.
However, no general enumeration of unlabeled $k$-trees appears in the literature to date.

To begin, we establish two definitions for substructures of $k$-trees which we will use extensively in our analysis.
\begin{definition}
  \label{def:hedfront}
  A \emph{hedron} of a $k$-tree is a $\pbrac{k+1}$-clique and a \emph{front} is a $k$-clique.
\end{definition}
We will frequently describe $k$-trees as assemblages of hedra attached along their fronts rather than using explicit graph-theoretic descriptions in terms of edges and vertices, keeping in mind that the structure of interest is graph-theoretic and not geometric.
The recursive addition of a single vertex and its connection by edges to an existing $k$-clique in Definition \ref{def:ktree} is then interpreted as the attachment of a hedron to an existing one along some front, identifying the $k$ vertices they have in common.
The analogy to the recursive definition of conventional trees is clear, and in fact the class $\mathfrak{a}$ of trees may be recovered by setting $k = 1$.
For higher $k$, the structures formed are still distinctively tree-like; for example, $2$-trees are formed by gluing triangles together along their edges without forming loops of triangles (see Figure \ref{fig:ex2tree}), while $3$-trees are formed by gluing tetrahedra together along their triangular faces without forming loops of tetrahedra.

\begin{figure}[htb]
  \centering
  \begin{tikzpicture}
    \SetGraphUnit{2}
    \GraphInit[vstyle=normal]
    \Vertex{a}

    \NOWE(a){d}
    \Edge(a)(d)

    \NOEA(d){c}
    \Edge(a)(c)
    \Edge(d)(c)
    
    \WE(d){b}
    \Edge(a)(b)
    \Edge(c)(b)
    
    \NOEA(a){f}
    \Edge(a)(f)
    \Edge(c)(f)
    
    \NO(f){e}
    \Edge(f)(e)
    \Edge(c)(e)
  \end{tikzpicture}
  \caption{A (vertex-labeled) $2$-tree}
  \label{fig:ex2tree}
\end{figure}

In graph-theoretic contexts, it is conventional to label graphs on their vertices and possibly their edges.
However, for our purposes, it will be more convenient to label hedra and fronts.
Throughout, we will treat the species $\mathfrak{a}_{k}$ of $k$-trees as a two-sort species, with $X$-labels on the hedra and $Y$-labels on their fronts; in diagrams, we will generally use capital letters for the hedron-labels and positive integers for the front-labels (see Figure \ref{fig:exlab2tree}).

\begin{figure}[htb]
  \centering
  \begin{tikzpicture}
    \SetGraphUnit{3}
    \GraphInit[vstyle=Hasse]
    \SetUpEdge[labelstyle={draw}]

    \Vertex{a}

    \NOWE(a){d}
    \Edge[label=2](a)(d)

    \NOEA(d){c}
    \Edge[label=4](a)(c)
    \Edge[label=5](d)(c)

    \node at (barycentric cs:a=1,d=1,c=1) {B};
    
    \WE(d){b}
    \Edge[label=1](a)(b)
    \Edge[label=6](c)(b)

    \node at (barycentric cs:b=1,d=1) {D};
    
    \NOEA(a){f}
    \Edge[label=9](a)(f)
    \Edge[label=3](c)(f)

    \node at (barycentric cs:a=1,c=1,f=1) {C};
    
    \NO(f){e}
    \Edge[label=7](f)(e)
    \Edge[label=8](c)(e)

    \node at (barycentric cs:f=1,c=1,e=1) {A};

  \end{tikzpicture}
  \caption{A (hedron-and-front--labeled) $2$-tree}
  \label{fig:exlab2tree}
\end{figure}

\section{The dissymmetry theorem for $k$-trees}\label{s:dissymk}
Studies of tree-like structures---especially those explicitly informed by the theory of species---often feature decompositions based on \emph{dissymmetry}, which allow enumerations of unrooted structures to be recharacterized in terms of rooted structures.
For example, as seen in \cite[\S 4.1]{bll:species}, the species $\mathfrak{a}$ of trees and $\specname{A} = \pointed{\mathfrak{a}}$ of rooted trees are related by the equation
\begin{equation*}
  \specname{A} + \specname{E}_{2} \pbrac{\specname{A}} = \mathfrak{a} + \specname{A}^{2}
\end{equation*}
where the proof hinges on a recursive structural decomposition of trees.
In this case, the species $\specname{A}$ is relatively easy to characterize explicitly, so this equation serves to characterize the species $\mathfrak{a}$, which would be difficult to do directly.

A similar theorem holds for $k$-trees.
\begin{theorem}
  \label{thm:dissymk}
  The species $\pointed[X]{\mathfrak{a}}_{k}$ and $\pointed[Y]{\mathfrak{a}}_{k}$ of $k$-trees rooted at hedra and fronts respectively, $\pointed[\overline{XY}]{\mathfrak{a}}_{k}$ of $k$-trees rooted at a hedron with a designated front, and $\mathfrak{a}_{k}$ of unrooted $k$-trees are related by the equation
  \begin{equation}
    \label{eq:dissymk}
    \pointed[X]{\mathfrak{a}}_{k} + \pointed[Y]{\mathfrak{a}}_{k} = \mathfrak{a}_{k} + \pointed[\overline{XY}]{\mathfrak{a}}_{k}
  \end{equation}
  as an isomorphism of species.
\end{theorem}

\begin{proof}
  We give a bijective, natural map from $\pbrac{\pointed[X]{\mathfrak{a}}_{k} + \pointed[Y]{\mathfrak{a}}_{k}}$-structures on the left side to $\pbrac{\mathfrak{a}_{k} + \pointed[\overline{XY}]{\mathfrak{a}}_{k}}$-structures on the right side.
  Define a \emph{$k$-path} in a $k$-tree to be a non-returning sequence of consecutively adjacent hedra and fronts, and define the \emph{length} of a $k$-path to be the total number of hedra and fronts along it.
  Note that the ends of every maximal $k$-path in a $k$-tree are fronts.
  It is easily verified, as in \cite{kob:ktlogspace}, that every $k$-tree has a unique \emph{center} clique (either a hedron or a front) which is the midpoint of every longest $k$-path (or, equivalently, has the greatest $k$-eccentricity, defined appropriately).
  
  An $\pbrac{\pointed[X]{\mathfrak{a}}_{k} + \pointed[Y]{\mathfrak{a}}_{k}}$-structure on the left-hand side of the equation is a $k$-tree $T$ rooted at some clique $c$, which is either a hedron or a front.
  Suppose that $c$ is the center of $T$.
  We then map $T$ to its unrooted equivalent in $\mathfrak{a}_{k}$ on the right-hand side.
  This map is a natural bijection from its preimage, the set of $k$-trees rooted at their centers, to $\mathfrak{a}_{k}$, the set of unrooted $k$-trees.

  Now suppose that the root clique $c$ of the $k$-tree $T$ is \emph{not} the center, which we denote $C$.
  Identify the clique $c'$ which is adjacent to $c$ along the $k$-path from $c$ to $C$.
  We then map the $k$-tree $T$ rooted at the clique $c$ to the same tree $T$ rooted at \emph{both} $c$ and its neighbor $c'$.
  This map is also a natural bijection, in this case from the set of $k$-trees rooted at vertices which are \emph{not} their centers to the set $\pointed[\overline{XY}]{\mathfrak{a}}_{k}$ of $k$-trees rooted at an adjacent hedron-front pair.

  When combined, these maps give the desired isomorphism of species in equation \eqref{eq:dissymk}.
\end{proof}

In general we will reformulate the dissymmetry theorem as follows:
\begin{corollary}
  \label{cor:dissymkreform}
  For the various forms of the species $\mathfrak{a}_{k}$ as above, we have
  \begin{equation}
    \label{eq:dissymkreform}
    \mathfrak{a}_{k} = \pointed[X]{\mathfrak{a}}_{k} + \pointed[Y]{\mathfrak{a}}_{k} - \pointed[\overline{XY}]{\mathfrak{a}}_{k}.
  \end{equation}
  as an isomorphism of ordinary species.
\end{corollary}

Theorem \ref{thm:dissymk} and the consequent equation \eqref{eq:dissymkreform} allow us to reframe enumerative questions about generic $k$-trees in terms of questions about $k$-trees rooted in various ways.
However, the rich internal symmetries of large cliques obstruct direct analysis of these rooted structures.
We need to break these symmetries to proceed.

\section{Coherently-oriented $k$-trees}
\subsection{Symmetry-breaking}\label{ss:symbreak}
In the case of the species $\specname{A} = \pointed{\mathfrak{a}}_{1}$ of trees, we may obtain a simple recursive functional equation \cite[\S 1, eq.~(9)]{bll:species}:
\begin{equation}
  \label{eq:rtrees}
  \specname{A} = X \cdot \specname{E} \pbrac{\specname{A}}.
\end{equation}
This completely characterizes the combinatorial structure of the class of trees.

However, in the more general case of $k$-trees, no such simple relationship obtains; attached to a given hedron is a collection of sets of hedra (one such set per front), but simply specifying which fronts to attach to which does not fully specify the attachings, and the structure of that collection of sets is complex.
We will break this symmetry by adding additional structure which we can later remove using the theory of quotient species.

\begin{definition}
  \label{def:mirrorfronts}
  Let $h_{1}$ and $h_{2}$ be two hedra joined at a front $f$, hereafter said to be \emph{adjacent}.
  Each other front of one of the hedra shares $k-1$ vertices with $f$; we say that two fronts $f_{1}$ of $h_{1}$ and $f_{2}$ of $h_{2}$ are \emph{mirror with respect to $f$} if these shared vertices are the same, or equivalently if $f_{1} \cap f = f_{2} \cap f$.
  There is exactly one face of $h_{2}$ mirror to each specified front of $h_{1}$ with respect to their shared front $f$.
\end{definition}

\begin{comment} Don't think we need this after all...
  \begin{definition}\label{def:cycord}
    For a set $A$, define a \emph{cyclic order of $A$} to be a labeling of the cyclic digraph $\overrightarrow{C}_{\abs{A}}$ by $A$ and let $\cyc A$ be the set of such linear orders. Let $\lin A$ be the set of linear orders on $A$. Let $\psi_{A}: \lin A \to \cyc A$ (hereafter denoted simply $\psi$ when the set is unambiguous) send each linear order $\ell$ to the cyclic order obtained by decorating $\overrightarrow{C}_{\abs{A}}$ with $\ell$ in order. (Note that this map is $\abs{A}$-to-one.) Then a \emph{linearization} of a given cyclic order $c \in \cyc A$ is an element of $\psi^{-1} \pbrac{c}$.
  \end{definition}
\end{comment}

\begin{definition}
  \label{def:coktree}
  Define an \emph{orientation} of a hedron to be a cyclic ordering of the set of its fronts and an \emph{orientation} of a $k$-tree to be a choice of orientation for each of its hedra.
  If two oriented hedra share a front, their orientations are \emph{compatible} if they correspond under the mirror bijection.
  Then an orientation of a $k$-tree is \emph{coherent} if every pair of adjacent hedra is compatibly-oriented.
\end{definition}
See Figure \ref{fig:exco2tree} for an example.
Note that every $k$-tree admits many coherent orientations---any one hedron of the $k$-tree may be oriented freely, and a unique orientation of the whole $k$-tree will result from each choice of such an orientation of one hedron.
We will denote by $\vec{\mathfrak{a}}_{k}$ the species of coherently-oriented $k$-trees.

By shifting from the general $k$-tree setting to that of coherently-oriented $k$-trees, we break the symmetry described above.
If we can now establish a group action on $\vec{\mathfrak{a}}_{k}$ whose orbits are generic $k$-trees we can use the theory of quotient species to extract the generic species $\mathfrak{a}_{k}$.
First, however, we describe an encoding procedure which will make future work more convenient.

\begin{figure}[htb]
  \centering
  \begin{tikzpicture}
    \SetGraphUnit{3}
    \GraphInit[vstyle=Hasse]
    \SetUpEdge[labelstyle={draw}]

    \Vertex{a}

    \NOWE(a){d}
    \Edge[label=2](a)(d)

    \NOEA(d){c}
    \Edge[label=4](a)(c)
    \Edge[label=5](d)(c)

    \coordinate (B) at (barycentric cs:a=1,d=1.25,c=1);
    \node at (B) {B};
    \cyccwr[.5cm]{(B)};
    
    \WE(d){b}
    \Edge[label=1](a)(b)
    \Edge[label=6](c)(b)

    \coordinate (D) at (barycentric cs:b=1,d=1.25);
    \node at (D) {D};
    \cyccwr[.5cm]{(D)};
    
    \NOEA(a){f}
    \Edge[label=9](a)(f)
    \Edge[label=3](c)(f)

    \coordinate (C) at (barycentric cs:a=1,c=1,f=1.25);
    \node at (C) {C};
    \cycccwl[.5cm]{(C)};
    
    \NO(f){e}
    \Edge[label=7](f)(e)
    \Edge[label=8](c)(e)

    \coordinate (A) at (barycentric cs:f=1,c=1,e=1.75);
    \node at (A) {A};
    \cyccwl[.5cm]{(A)};
    
  \end{tikzpicture}
  \caption{A coherently-oriented $2$-tree}
  \label{fig:exco2tree}
\end{figure}

\subsection{Bicolored tree encoding}\label{ss:bctree}
Although $k$-trees are graphs (and hence made up simply of edges and vertices), their structure is more conveniently described in terms of their simplicial structure of hedra and fronts.
Indeed, if each hedron has an orientation of its faces and we choose in advance which hedra to attach to which by what fronts, the requirement that the resulting $k$-tree be coherently oriented is strong enough to characterize the attaching completely.
We thus pass from coherently-oriented $k$-trees to a surrogate structure which exposes the salient features of this attaching structure more clearly---structured bicolored trees in the spirit of the $R, S$-enriched bicolored trees of \cite[\S 3.2]{bll:species}.

A $\pbrac{\specname{C}_{k+1}, \specname{E}}$-enriched bicolored tree is a bicolored tree each black vertex of which carries a $\specname{C}_{k+1}$-structure (that is, a cyclic ordering on $k+1$ elements) on its white neighbors.
(The $\specname{E}$-structure on the black neighbors of each white vertex is already implicit in the bicolored tree itself.)
For later convenience, we will sometimes call such objects \emph{$k$-coding trees}, and we will denote by $\specname{CT}_{k}$ the species of such $k$-coding trees.

We now define a map $\beta: \vec{\mathfrak{a}}_{k} \sbrac{n} \to \specname{CT}_{k} \sbrac{n}$.
For a given coherently-oriented $k$-tree $T$ with $n$ hedra:
\begin{itemize}
  \item For every hedron of $T$ construct a black vertex and for every front a white vertex, assigning labels appropriately.
  \item For every black-white vertex pair, construct a connecting edge if the white vertex represents a front of the hedron represented by the black vertex.
  \item Finally, enrich the collection of neighbors of each black vertex with a $\specname{C}_{k+1}$-structure inherited directly from the orientation of the $k$-tree $T$.
\end{itemize}
The resulting object $\beta \pbrac{T}$ is clearly a $k$-coding tree with $n$ black vertices.

We can recover a $T$ from $\beta \pbrac{T}$ by following the reverse procedure.
For an example, see Figure \ref{fig:exbctree}, which shows the $2$-coding tree associated to the coherently-oriented $2$-tree of Figure \ref{fig:exco2tree}.
Note that, for clarity, we have rendered the black vertices (corresponding to hedra) with squares.

\begin{figure}[htb]
  \centering
  \begin{tikzpicture}
    \SetGraphUnit{1.5}
    \GraphInit[vstyle=normal]

    \Vertex[style=ynode]{4}


    \SOWE[style=xnode](4){B}
    \cyccwr{(B)};
    \Edge(4)(B)

    \WE[style=ynode](B){5}
    \Edge(B)(5)

    \SOEA[style=ynode](B){2}
    \Edge(B)(2)


    \NOWE[style=xnode](4){D}
    \cyccwr{(D)};
    \Edge(4)(D)
    
    \WE[style=ynode](D){1}
    \Edge(D)(1)

    \NOEA[style=ynode](D){6}
    \Edge(D)(6)


    \EA[style=xnode](4){C}
    \cycccwr{(C)};
    \Edge(4)(C)

    \SOEA[style=ynode](C){9}
    \Edge(C)(9)

    \NOEA[style=ynode](C){3}
    \Edge(C)(3)

    \NO[style=xnode](3){A}
    \cyccwl{(A)};
    \Edge(3)(A)

    \NOWE[style=ynode](A){8}
    \Edge(A)(8)

    \NOEA[style=ynode](A){7}
    \Edge(A)(7)
    
  \end{tikzpicture}
  \caption{A $\pbrac{\specname{C}_{k+1}, \specname{E}}$-enriched bicolored tree encoding a coherently-oriented $2$-tree}
  \label{fig:exbctree}
\end{figure}

\begin{theorem}\label{thm:bctreeenc}
  The map $\beta$ induces an isomorphism of species $\vec{\mathfrak{a}}_{k} \simeq \specname{CT}_{k}$.
\end{theorem}

\begin{proof}
  TODO: This is not totally clear.
  It is clear that $\beta$ sends each coherently-oriented $k$-tree to a unique $k$-coding tree, and that this map commutes with permutations on the label sets (and thus is categorically natural).
  To show that $\beta$ induces a species isomorphism, then, we need only show that $\beta$ is a surjection onto $\specname{CT}_{k} \sbrac{n}$ for each $n$.
  
  First, note that there are exactly $k!$ coherently-oriented $k$-trees with one hedron---one for each cyclic ordering of the $k+1$ front labels.
  There are also $k!$ coding trees with one black vertex, and the encoding $\beta$ is clearly a natural bijection between these two sets.
  Thus, the species $\vec{\mathfrak{a}}_{k}$ of coherently-oriented $k$-trees and $\specname{CT}_{k}$ of $k$-coding trees have contact of order $1$.

  Now, by way of induction, suppose $\vec{\mathfrak{a}}_{k}$ and $\specname{CT}_{k}$ have contact of order $n \geq 1$; that is, that the encoding $\beta$ is a natural bijection for up to $n$ hedra and up to $n$ black vertices.
  Let $C$ be a $k$-coding tree with $n+1$ black vertices.
  Then let $C_{1}$ and $C_{2}$ be two distinct sub--$k$-coding trees of $C$, each obtained from $C$ by removing one black node which has only one white neighbor which is not a leaf.
  Then, by hypothesis, there exist coherently-oriented $k$-trees $T_{1}$ and $T_{2}$ with $n$ hedra such that $\beta \pbrac{T_{1}} = C_{1}$ and $\beta \pbrac{T_{2}} = C_{2}$.
  Moreover, $\beta \pbrac{T_{1} \cap T_{2}} = \beta \pbrac{T_{1}} \cap \beta \pbrac{T_{2}}$, and this $k$-coding tree has $n-1$ black vertices, so $T_{1} \cap T_{2}$ has $n-1$ hedra.
  Thus, $T = T_{1} \cup T_{2}$ is a coherently-oriented $k$-tree with $n+1$ black hedra, and $\beta \pbrac{T} = C$ as desired.
  Thus, $\beta^{-1} \pbrac{\beta \pbrac{T_{1}} \cup \beta \pbrac{T_{2}}} = T_{1} \cup T_{2} = T$, and hence $\vec{\mathfrak{a}}_{k}$ and $\specname{CT}_{k}$ have contact of order $n+1$.
\end{proof}

$\vec{\mathfrak{a}}_{k}$ and $\specname{CT}_{k}$ are isomorphic as species, but $k$-coding trees are much simpler than coherently-oriented $k$-trees as graphs.
Moreover, $k$-coding trees are doubly-enriched bicolored trees as in \cite[\S 3.2]{bll:species}, for which the authors of that text develop a system of functional equations which fully characterizes the cycle index of such a species.
We thus will proceed in the following sections with a study of the species $\specname{CT}_{k}$, anticipating that any results we obtain will be of value to our efforts to enumerate $k$-trees.

\subsection{Functional decomposition of $k$-coding trees}\label{ss:codecomp}
With the encoding $\beta: \vec{\mathfrak{a}}_{k} \to \specname{CT}_{k}$, we now have direct graph-theoretic access to the attaching structure of coherently-oriented $k$-trees.
We therefore turn our attention to the $k$-coding trees themselves to produce a recursive decomposition.
As with $k$-trees, we will study rooted versions of the species $\specname{CT}_{k}$ of $k$-coding trees first, anticipating that they later will be useful in a dissymmetry analysis.

Adopting the standard species-theoretic notation for pointing, let $\pointed[X]{\specname{CT}}_{k}$ denote the species of $k$-coding trees rooted at black vertices, $\pointed[Y]{\specname{CT}}_{k}$ denote the species of $k$-coding trees rooted at white vertices, and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ denote the species of $k$-coding trees rooted at edges (that is, at adjacent black-white pairs).
By construction, a $\pointed[X]{\specname{CT}}_{k}$-structure consists of a single $X$-label and a cyclically-ordered $\pbrac{k+1}$-set of $\pointed[Y]{\specname{CT}}_{k}$-structures.
See Figure \ref{fig:ctxconst} for an example of this construction.

\begin{figure}[htb]
  \centering
  \def\kval{4}
  \begin{tikzpicture}
    \pgfmathparse{int(1+\kval)} %int necessary for clean captions later
    \let\numfronts\pgfmathresult

    \pgfmathparse{180/\numfronts}
    \let\childshift\pgfmathresult

    \node [style=xnode] (root) at (0,0) {$X$};   
    \cycccwr{(root)};

    \draw (180/\numfronts:1) node {$\specname{C}_{\numfronts}$};

    \foreach \i in {0, ..., \kval} {
      \pgfmathparse{360*\i/\numfronts}
      \let\theta\pgfmathresult     
      
      \node [style=ynode] (child\i) at (\theta:3) {$Y$};
      \path [draw] (root) -- (child\i);
      \draw (child\i) ++(\theta+90:1) node {$\pointed[Y]{\specname{CT}}_{\kval}$};

      \draw (child\i) ++(\theta:1cm) ++(180+\theta-\childshift:2cm) arc (180+\theta-\childshift:180+\theta+\childshift:2cm);

      \path [draw] (child\i) -- ++(\theta:2) node [rotate=\theta,fill=white] {$\cdots$};
      \path [draw] (child\i) -- ++(\theta+\childshift:2);
      \path [draw] (child\i) -- ++(\theta-\childshift:2);
    }
    
  \end{tikzpicture}
  \caption{An example $\pointed[X]{\specname{CT}}_{\kval}$-structure, rooted at the $X$-vertex.}
  \label{fig:ctxconst}
\end{figure}

Similarly, a $\pointed[Y]{\specname{CT}}_{k}$-structure essentially consists of a single $Y$-label and a (possibly empty) set of $\pointed[X]{\specname{CT}}_{k}$-structures, but with some modification.
We do not wish to multiply-label the white vertex or attach new black children to it at this stage, so we must modify the descendant $\pointed[X]{\specname{CT}}_{k}$-structures to avoid this.
Specifically, the structure around a black vertex which is a child of a white vertex consists of an $X$ label and a linearly-ordered $k$-set of $\pointed[Y]{\specname{CT}}_{k}$-structures.
Thus, a $\pointed[Y]{\specname{CT}}_{k}$-structure consists of a $Y$-label and a set of pairs of an $X$ label and an $\specname{L}_{k}$-structure of $\pointed[Y]{\specname{CT}}_{k}$-structures.
We note here for conceptual consistency that in fact $\specname{L}_{k} = \deriv{\specname{C}}_{k+1}$ for $\specname{L}$ the species of linear orders and $\specname{C}$ the species of cyclic orders and that $\deriv{\specname{E}} = \specname{E}$ for $\specname{E}$ the species of sets; readers familiar with the $R, S$-enriched bicolored trees of \cite[\S 3.2]{bll:species} will recognize echoes of their decomposition in these facts.

Finally, a $\pointed[\overline{XY}]{\specname{CT}}_{k}$-structure is simply a $\pbrac{X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}}$-structure as described above (corresponding to the black vertex) combined with a $\pointed[Y]{\specname{CT}}_{k}$-structure (corresponding to the white vertex).
For reasons that will become clear later, we note that we can combine the root white vertex into the linear order by making it last, thus representing a $\pointed[\overline{XY}]{\specname{CT}}_{k}$-structure instead as an $X \cdot \specname{L}_{k+1} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$-structure.
See Figure \ref{fig:ctxyconst} for an example of this construction.

\begin{figure}[htb]
  \centering
  \def\kval{4}
  \begin{tikzpicture}
    \pgfmathparse{int(1+\kval)} %int necessary for clean captions later
    \let\numfronts\pgfmathresult

    \pgfmathparse{180/\numfronts}
    \let\childshift\pgfmathresult

    \node [style=xnode] (root) at (0,0) {$X$};
    \draw[->,postaction={decorate},decoration={markings, mark = at position 1 with {\arrow{triangle 90}}}] (root) ++(2*\childshift:1cm) arc (2*\childshift:360:1cm); %What a mess! At least it works now...

    \draw (root) -- ++(0:3) [dashed] node [fill=white] {$\cdots$};

    \draw (180/\numfronts:1) node {$\specname{L}_{\numfronts}$};

    \foreach \i in {1, ..., \kval} {
      \pgfmathparse{360*\i/\numfronts}
      \let\theta\pgfmathresult     
      
      \node [style=ynode] (child\i) at (\theta:3) {$Y$};
      \path [draw] (root) -- (child\i);
      \draw (child\i) ++(\theta+90:1) node {$\pointed[Y]{\specname{CT}}_{\kval}$};

      \draw (child\i) ++(\theta:1cm) ++(180+\theta-\childshift:2cm) arc (180+\theta-\childshift:180+\theta+\childshift:2cm);

      \path [draw] (child\i) -- ++(\theta:2) node [rotate=\theta,fill=white] {$\cdots$};
      \path [draw] (child\i) -- ++(\theta+\childshift:2);
      \path [draw] (child\i) -- ++(\theta-\childshift:2);
    }
    
  \end{tikzpicture}
  \caption{An example $\pointed[\overline{XY}]{\specname{CT}}_{\kval}$-structure, rooted at the $X$-vertex and the dashed edge adjoining it.}
  \label{fig:ctxyconst}
\end{figure}

The various species of rooted $k$-coding threes are therefore related by a system of functional equations:
\begin{theorem}
  \label{thm:funcdecompct}
  For the (ordinary) species $\pointed[X]{\specname{CT}}_{k}$ of $X$-rooted $k$-coding trees, $\pointed[Y]{\specname{CT}}_{k}$ of $Y$-rooted $k$-coding trees, and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ of edge-rooted $k$-coding trees, we have the functional relationships
  \begin{subequations}
    \label{eq:ctfunc}
    \begin{align}
      \pointed[X]{\specname{CT}}_{k} &= X \cdot \specname{C}_{k+1} \pbrac{\pointed[Y]{\specname{CT}}_{k}} \label{eq:ctxfunc} \\
      \pointed[Y]{\specname{CT}}_{k} &= Y \cdot \specname{E} \pbrac{X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}} \label{eq:ctyfunc} \\
      \pointed[\overline{XY}]{\specname{CT}}_{k} &= \pointed[Y]{\specname{CT}}_{k} \cdot X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}} = X \cdot \specname{L}_{k+1} \pbrac{\pointed[Y]{\specname{CT}}_{k}} \label{eq:ctxyfunc}
    \end{align}
  \end{subequations}
  as isomorphisms of ordinary species.
\end{theorem}

However, a recursive characterization of the various ordinary species of $k$-coding trees is insufficient to characterize the species of $k$-trees itself, since $k$-coding trees represent $k$-trees with coherent orientations.

\section{Generic $k$-trees}\label{s:genkt}
To remove the additional structure of coherent orientation imposed on $k$-trees before their conversion to $k$-coding trees, we now apply the theory of $\Gamma$-species developed in \ref{s:quot}.
We might hope to develop a group action under which ordinary $k$-trees are naturally identified with orbits of coherently-oriented $k$-trees.
Unfortunately:
\begin{lemma}
  \label{lem:notransac}
  For $k \geq 3$, no transitive action of any group on the set $\cyc_{\sbrac{k+1}}$ of cyclic orders on $\sbrac{k+1}$ commutes with the action of $\symgp{k+1}$ that permutes labels.
\end{lemma}
\begin{proof}
  We represent the elements of $\cyc_{\sbrac{k+1}}$ as cyclic permutations on the alphabet $\sbrac{k+1}$; then the action of $\symgp{k+1}$ that permutes labels is exactly the conjugation action on these permutations.
  Consider an action of a group $G$ on $\cyc_{\sbrac{k+1}}$ that commutes with this conjugation action.
  Then, for any $g \in G$ and any $c \in \cyc_{\sbrac{k+1}}$, we have that
  \begin{equation}
    \label{eq:transaction}
    g \cdot c = g \cdot c c c^{-1} = c \pbrac{g \cdot c} c^{-1}
  \end{equation}
  and so $c$ and $g \cdot c$ commute.
  Thus, $c$ commutes with every element of its orbit under the action of $G$, so it contains only powers of $c$.
  But, for $k \geq 3$, not all elements of $\cyc_{\sbrac{k+1}}$ are powers of each other, so the action is not transitive.
\end{proof}

We thus cannot hope to attack the coherent orientations of $k$-trees by acting directly on the cyclic orderings of fronts.
Accordingly, we cannot simply apply the results of \S \ref{ss:codecomp} to compute a $\Gamma$-species $\specname{CT}_{k}$ with respect to some hypothetical action of a group $\Gamma$ whose orbits correspond to generic $k$-trees.
Instead, we will use the additional structure on \emph{rooted} coherently-oriented $k$-trees; with rooting, the cyclic orders around black vertices are converted into linear orders, for which there is a natural action of $\symgp{k+1}$.

As an aside, we also note that the fact that the obstruction of Lemma \ref{lem:notransac} occurs only for $k \geq 3$ would suggest that a more straightforward course than ours would be available specifically in the case of $2$-trees.
Indeed, in \cite{gessel:spec2trees}, the fact that there \emph{does} exist a well-defined action of $\symgp{2}$ on $\cyc_{\sbrac{3}}$ which simply reverses the cyclic ordering is exploited to study $2$-trees species-theoretically.

\subsection{Group actions on $k$-coding trees}\label{ss:actct}

We have noted previously that every labeled $k$-tree admits exactly $k!$ coherent orientations.
Thus, there are $k!$ distinct $k$-coding trees associated to each labeled $k$-tree, which differ only in the $\specname{C}_{k+1}$-structures on their black vertices.
Consider a rooted $k$-coding tree $T$ and a black vertex $v$ which is not the root vertex.
Then one white neighbor of $v$ is the `parent' of $v$ (in the sense that lies on the path from $v$ to the root).
We thus can convert the cyclic order on the $k+1$ white neighbors of $v$ as a linear order by choosing the parent white neighbor to be last.
There is a natural, transitive, label-independent action of $\symgp{k+1}$ on the set of such linear orders which induces an action on the cyclic orders from which the linear orders are derived.
If we apply the action of some $\sigma \in \symgp{k+1}$ to this linear order, however, we must also permute the cyclic orders of the descendant black vertices of $v$ in order to restore the coherency of the orientation of the component of the $k$-tree associated to $T$ corresponding to the structure descending from $v$.

As noted in \S \ref{ss:symbreak}, there does exist a (unique) choice of orientation for each descendant which restores orientation coherency.
By linearizing the cyclic orders of the descendants as we did for the initial black vertex, we can interpret them as linear orders as well, and thus interpret the map that sends a given orientation to its post-$\sigma$ version as another permutation in $\symgp{k+1}$.
It is clear that, for each immediate black descendant $v'$ of $v$, the permutation $\sigma'$ applied to the linear order of the white children of $v'$ will be determined by the initial permutation $\sigma$ and by the position $i$ of the white vertex joining $v$ to $v'$ in the initial linear ordering at $v$.
In particular, this permutation $\sigma'$ is precisely that induced by passing over the mirror bijection from $v'$ to $v$, applying $\sigma$, and then passing back.
We can express this procedure in formulaic terms:
\begin{theorem}
  \label{thm:rhodef}
  If a permutation $\sigma \in \symgp{k+1}$ is applied to linearized orientation of a black vertex $v$ in rooted $k$-coding tree, the permutation which must be applied to the linearized orientation a child black vertex $v'$ which was attached to the $i$th white child of $v$ (with respect to the linear ordering induced by the orientation) to preserve the coherence of the associated $k$-tree is $\rho_{i} \pbrac{\sigma}$, where $\rho_{i}$ is the map
  \begin{equation}
    \label{eq:rhodef}
    \rho_{i} \pbrac{\sigma}: a \mapsto \sigma \pbrac{i + a} - \sigma \pbrac{i}
  \end{equation}
  where all sums and differences are reduced to their representatives modulo $k+1$ in $\cbrac{1, 2, \dots, k+1}$.
\end{theorem}
\begin{proof}
  Let $v$ denote the base black vertex and $v'$ denote an immediate black descendant, which is attached to $v$ by the white vertex $1$, which we suppose to be in position $i$ in the linear order induced by the original orientation of $v$.
  Let $2$ denote the white child of $v'$ which is $a$th in the linear order induced by the original orientation around $v'$.
  It is mirror to the white child $3$ of $v$ which is $\pbrac{i+a}$th in the linear order induced by the original orientation around $v$.
  After the action of $\sigma$ is applied, vertex $3$ is $\sigma \pbrac{i+a}$th in the new linear order around $v$.
  We require that $2$ is still mirror to $3$, so we must move it to position $\sigma \pbrac{i + a} - \sigma \pbrac{i}$ when we create a new linear order around $v'$.
  This completes the proof.
\end{proof}
This procedure is depicted in Figure \ref{fig:rhoapp}.

As an aside, we note that, although the construction $\rho$ depends on $k$, in practice the value of $k$ will be fixed in any given context, so we suppress it in the notation.

\begin{figure}[htbp]
  \centering
  \begin{tikzpicture}
    \SetGraphUnit{3.5}

    \Vertex[style=xnode,Math=true]{v}
    \cycccwr{(v)};

    \EA[style=ynode](v){3}
    \path (v) edge [bend right=45, thick] node [below](a3d){$i+a$} (3);
    \path (v) edge [bend left=45, thick] node [above](a3u){$\sigma \pbrac{i+a}$} (3);
    \path (a3d) edge [->, dashed, thick] node [auto]{$\sigma$} (a3u);

    \WE[style=ynode](v){1}
    \path (v) edge [bend left=45, thick] node [below](a1d){$i$} (1);
    \path (v) edge [bend right=45, thick] node [above](a1u){$\sigma \pbrac{i}$} (1);
    \path (a1d) edge [->, dashed, thick] node [auto]{$\sigma$} (a1u);
    
    \WE[style=xnode, Math=true](1){v'}
    \cyccwr{(v')};
    \path (v') edge [thick] node [auto](b1){$0$} (1);

    \WE[style=ynode](v'){2}
    \path (v') edge [bend left=45, thick] node [below](b2d){$a$} (2);
    \path (v') edge [bend right=45, thick] node [above](b2u){$\sigma \pbrac{i+a} - \sigma \pbrac{i}$} (2);
    \path (b2d) edge [->, dashed, thick] node [auto]{$\rho_{i} \pbrac{\sigma}$} (b2u);

    \path (b2d) edge [->, dotted, thick, bend right=15] node [auto]{$\mu$} (a3d);
    \path (b2u) edge [->, dotted, thick, bend left=15] node [auto]{$\mu$} (a3u);
  \end{tikzpicture}
  \caption[The permutation-modifying map $\rho$]{Application of a permutation $\sigma$ to the orientation of a non-root black vertex $v$.
    The vertices $2$ and $3$ are mirror in the original orientation (lower set of edges), as shown by the arrows $\mu$, so we must preserve this mirror relation when we apply $\sigma$.
    The permutation $\sigma$ moves $3$ from the $\pbrac{i+a}$th place to the $\sigma \pbrac{i+a}$th, so $\rho_{i} \pbrac{\sigma}$ must carry $2$ from the $a$th place to the $\pbrac{\sigma \pbrac{i+a} - \sigma \pbrac{i}}$th.}
  \label{fig:rhoapp}
\end{figure}

Note that, in particular, $\rho_{i} \pbrac{\sigma} \pbrac{k+1} = k+1$ for any $\sigma \in \symgp{k+1}$ and any $i$.
Thus, the resulting permutations do not disturb the parent white vertices of descendant black vertices in their orientations, as we require.
Therefore, the $\rho$ procedure is compatible with the tree-like structure of a rooted $k$-coding tree.
We can thus apply the procedure in Theorem \ref{thm:rhodef} recursively to restore the coherence of all the descendant black vertices after applying $\sigma$ to the orientation of some black vertex.
Moreover, by construction, the orbit of a given black-rooted $k$-coding tree component under the action of $\symgp{k+1}$ will include the set of all such components corresponding to the different orientations of the same underlying $k$-tree component.

In cases where $\sigma$ is applied to a non-root black vertex $v$, the $\sigma \in \symgp{k+1}$ such that $\sigma \pbrac{k+1} \neq k+1$ will not be automorphisms at all, since such $\sigma$ will disturb the edge from $v$ to its parent white vertex.
In these cases, the subgroup of $\symgp{k+1}$ isomorphic to $\symgp{k}$ containing all $\sigma$ such that $\sigma \pbrac{k+1} = k+1$ will be the group of interest, so we will at times speak instead of an $\symgp{k}$-action.
$\symgp{k}$, understood as a subgroup of $\symgp{k+1}$ in this fashion, will act purely by isomorphisms on the orientations of non-root black vertices, and its orbits will indeed correspond to all the orientations of the associated $k$-tree structures.
We will abuse notation somewhat by having $\rho$ act on elements of both $\symgp{k}$ and $\symgp{k+1}$, relying on context to make clear what is the ambient group.

In light of Theorem \ref{thm:funcdecompct}, we now wish to adapt these ideas into explicit $\symgp{k}$- and $\symgp{k+1}$-actions on $\pointed[X]{\specname{CT}}_{k}$, $\pointed[Y]{\specname{CT}}_{k}$, and $\pointed[\overline{XY}]{\specname{CT}}_{k}$.
In the case of a $Y$-rooted $k$-coding tree $T$, we simply declare that each $\sigma \in \symgp{k}$ acts on $T$ by acting directly on each of the black vertices immediately adjacent to the root and then applying $\rho$-derived permutations recursively to their descendants.
Each orbit under this action then corresponds to all the coherent orientations of a single $Y$-rooted $k$-tree.
The same $\symgp{k}$-action serves equally well for edge-rooted $k$-coding trees, where (for purposes of applying the action of some $\sigma$) we can simply ignore the black vertex in the root.
Again, each orbit under this $\symgp{k}$-action corresponds to all the coherent orientations of a single $\overline{XY}$-rooted $k$-tree.

However, if we begin with an $X$-rooted $k$-coding tree, the cyclic ordering of the white neighbors of the root black vertex has no canonical choice of linearization.
If we make an arbitrary choice of one of the $k+1$ available linearizations, however, and thus convert to an edge-rooted $k$-coding tree, the full $\symgp{k+1}$-action defined previously can be applied directly to the root vertex.
Moreover, the orbit under this action of some edge-rooted $k$-coding tree $T$ with a choice of linearization at the root includes all possible linearizations of all possible $X$-rooted $k$-coding trees corresponding to the different coherent orientations of a single $k$-coding tree.
In addition, this action is compatible with the action of the subgroup $\symgp{k}$ in the previous paragraph.

\subsection{$k$-trees as quotients}\label{ss:ktquot}
Since these actions are label-independent, we may now speak of $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ as $\symgp{k}$-species and of $\pointed[\overline{XY}]{\specname{CT}}_{k}$ as a $\symgp{k+1}$-species.
Since the $\symgp{k}$- and $\symgp{k+1}$-actions on $\pointed[\overline{XY}]{\specname{CT}}_{k}$ are compatible, the potential ambiguity of this overloading of names is mostly avoided.
We will make explicit reference to $\pointed[\overline{XY}]{\specname{CT}}_{k}$ as a $\symgp{k}$- or $\symgp{k+1}$-species whenever it is important and not completely clear from context.
As a result of the above results, we can then relate the rooted $\Gamma$-species forms of $\specname{CT}_{k}$ to the various ordinary species forms of generic rooted $k$-trees in Theorem \ref{thm:dissymk}:
\begin{theorem}
  \label{thm:arootquot}
  For the various rooted forms of the ordinary species $\mathfrak{a}_{k}$ as in Theorem \ref{thm:dissymk} and the various rooted $\Gamma$-species forms of $\specname{CT}_{k}$ as in Theorem \ref{thm:funcdecompct} as $\symgp{k}$- and $\symgp{k+1}$-species, we have
  \begin{subequations}
    \label{eq:arootquot}
    \begin{align}
      \pointed[Y]{\mathfrak{a}}_{k} &= \faktor{\pointed[Y]{\specname{CT}}_{k}}{\symgp{k}} \label{eq:ayquot} \\
      \pointed[\overline{XY}]{\mathfrak{a}}_{k} &= \faktor{\pointed[\overline{XY}]{\specname{CT}}_{k}}{\symgp{k}} \label{eq:axyquot} \\
      \pointed[X]{\mathfrak{a}}_{k} &= \faktor{\pointed[\overline{XY}]{\specname{CT}}_{k}}{\symgp{k+1}} \label{eq:axquot}
    \end{align}
  \end{subequations}
  as isomorphisms of ordinary species, where $\pointed[\overline{XY}]{\specname{CT}}_{k}$ is an $\symgp{k}$-species in \eqref{eq:axyquot} and an $\symgp{k+1}$-species in \eqref{eq:axquot}.
\end{theorem}

As a result, we have explicit characterizations of all the rooted components of the original dissymmetry theorem \ref{thm:dissymk}.
To compute the cycle indices of these components (and thus the cycle index of $\mathfrak{a}_{k}$ itself), we need only compute the cycle indices of the various rooted $\specname{CT}_{k}$ species, which we will do using a combination of the functional equations \eqref{eq:ctfunc} and explicit consideration of automorphisms.

\section{Automorphisms and cycle indices}\label{s:ktcycind}
\subsection{$k$-coding trees: $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$}\label{ss:ctcycind}
Corollary \ref{cor:dissymkreform} of the dissymmetry theorem for $k$-trees has a direct analogue in terms of cycle indices:
\begin{theorem}
  \label{thm:dissymkci}
  For the various forms of the species $\mathfrak{a}_{k}$ as in \S \ref{s:dissymk}, we have
  \begin{equation}
    \label{eq:dissymkci}
    \ci{\mathfrak{a}_{k}} = \ci{\pointed[X]{\mathfrak{a}}_{k}} + \ci{\pointed[Y]{\mathfrak{a}}_{k}} - \ci{\pointed[\overline{XY}]{\mathfrak{a}}_{k}}.
  \end{equation}
\end{theorem}

Thus, we need to calculate the cycle indices of the three rooted forms of $\mathfrak{a}_{k}$.
From Theorem \ref{thm:arootquot} and by Theorem \ref{thm:qsci} we obtain:
\begin{theorem}
  \label{thm:aquotci}
  For the various forms of the species $\mathfrak{a}_{k}$ as in \S \ref{s:dissymk} and the various $\symgp{k}$-species and $\symgp{k+1}$-species forms of $\specname{CT}_{k}$ as in \S \ref{ss:actct}, we have
  \begin{subequations}
    \label{eq:aquotci}
    \begin{align}
      \ci{\pointed[Y]{\mathfrak{a}}_{k}} &= \qgci{\symgp{k}}{\pointed[Y]{\specname{CT}_{k}}} = \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\sigma} \label{eq:ayquotci} \\
      \ci{\pointed[\overline{XY}]{\mathfrak{a}}_{k}} &= \qgci{\symgp{k}}{\pointed[\overline{XY}]{\specname{CT}_{k}}} = \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \gci{\symgp{k}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} \label{eq:axyquotci} \\
      \ci{\pointed[X]{\mathfrak{a}}_{k}} &= \qgci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}_{k}}} = \frac{1}{\pbrac{k+1}!} \sum_{\sigma \in \symgp{k+1}} \gci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} \label{eq:axquotci}
    \end{align}
  \end{subequations}
\end{theorem}

We thus need only calculate the various $\Gamma$-cycle indices for the $\symgp{k}$-species and $\symgp{k+1}$-species forms of $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ to complete our enumeration of general $k$-trees.

In Theorem \ref{thm:funcdecompct}, the functional equations for the ordinary species $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ both include terms of the form $\specname{L}_{k} \circ \pointed[Y]{\specname{CT}}_{k}$.
The plethysm of ordinary species does have a generalization to $\Gamma$-species, as given in Definition \ref{def:gspeccomp}, but it does not correctly describe the manner in which $\symgp{k}$ acts on linear orders of $\pointed[Y]{\specname{CT}}_{k}$-structures in these recursive decompositions.
Recall from \S \ref{s:quot} that, for two $\Gamma$-species $F$ and $G$, an element $\gamma \in \Gamma$ acts on an $\pbrac{F \circ G}$-structure (colloquially, `an $F$-structure of $G$-structures') by acting independently on the $F$-structure and each of the $G$-structures independently.
In our action of $\symgp{k}$, however, the actions of $\sigma$ on the descendant $\pointed[Y]{\specname{CT}}_{k}$-structures are \emph{not} independent---they depend on the position of the structure in the linear ordering around the parent black vertex.
In particular, if $\sigma$ acts on some non-root black vertex, then $\rho_{i} \pbrac{\sigma}$ acts on the white vertex in the $i$th place, where in general $\rho_{i} \pbrac{\sigma} \neq \sigma$.

Thus, we consider automorphisms of these $\symgp{k}$-structures directly.
First, we consider the component species $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$.
\begin{lemma}
  \label{lem:ctyinvar}
  Let $B$ be a structure of the species $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$.
  Let $W_{i}$ be the $\pointed[Y]{\specname{CT}}_{k}$-structure in the $i$th position in the linear order.
  Then some $\sigma \in \symgp{k}$ acts as an automorphism of $B$ if and only if, for each $i \in \sbrac{k+1}$, we have $\rho_{i} \pbrac{\sigma} W_{i} \cong W_{\sigma \pbrac{i}}$.
\end{lemma}

\begin{proof}
  The $X$-label on the black root of $B$ is not affected by the application of $\sigma$, so it imposes no conditions.
  However, the $\specname{L}_{k}$-structure on the white children of the root is permuted by $\sigma$, and we apply to each of the $W_{i}$'s the action of $\rho_{i} \pbrac{\sigma}$.
  Thus, $\sigma$ is an automorphism of $B$ if and only if the combination of applying $\sigma$ to the linear order and $\rho_{i} \pbrac{\sigma}$ to each $W_{i}$ is an automorphism.
  Since $\sigma$ `carries' each $W_{i}$ onto $W_{\sigma \pbrac{i}}$, we must have that $\rho_{i} \pbrac{\sigma} W_{i} \cong W_{\sigma \pbrac{i}}$, as claimed.
  That this suffices is clear.
\end{proof}

Consider a structure $T$ of the $\symgp{k}$-species $\pointed[Y]{\specname{CT}}_{k}$ and an element $\sigma \in \symgp{k}$.
As discussed in \S \ref{ss:codecomp}, $T$ is composed of a $Y$-label and a set of $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$-structures.
$\sigma$ acts trivially on $Y$ and $\specname{E}$ and acts on each of the component $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$-structures independently.
For each of these component structures, by Lemma \ref{lem:ctyinvar}, we have that $\sigma$ is an automorphism if and only if $\sigma$ carries each $\pointed[Y]{\specname{CT}}_{k}$-structure to its $\rho_{i} \pbrac{\sigma}$-image.
Thus, when constructing $\sigma$-invariant $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$-structures, we must construct for each cycle of $\sigma$ a $\pointed[Y]{\specname{CT}_{k}}$-structure which is invariant under the application of \emph{all} the permutations $\rho_{i} \pbrac{\sigma}$ which will be applied to it along the cycle.
For $c$ the chosen cycle of $\sigma$, this permutation is $\prod_{i \in c} \rho_{i} \pbrac{\sigma}$, where the product is taken over any chosen linearization of the cyclic order of the terms in the cycle.
Once a choice of such a $\pointed[Y]{\specname{CT}}_{k}$-structure for each cycle of $\sigma$ is made, we can simply insert the structures into the $\specname{L}_{k}$-structure to build the desired $\sigma$-invariant $X \cdot \specname{L}_{k} \pbrac{\pointed[Y]{\specname{CT}}_{k}}$-structure.
Accordingly:
\begin{theorem}
  \label{thm:ctyfuncci}
  The $\symgp{k}$-cycle index for the species $\pointed[Y]{\specname{CT}}_{k}$ is characterized by the recursive functional equation
  \begin{multline}
    \label{eq:ctyfuncci}
    \gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\sigma} = p_{1} \sbrac{y} \\
    \times Z_{\specname{E}} \circ \pbrac{p_{1} \sbrac{x} \cdot \prod_{c \in C \pbrac{\sigma}} \gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\prod_{i \in c} \rho_{i} \pbrac{\sigma}} \sbrac{p_{\abs{c}} \sbrac{x}, p_{2 \abs{c}} \sbrac{x}, \dots; p_{\abs{c}} \sbrac{y}, p_{2 \abs{c}} \sbrac{y}, \dots}}.
  \end{multline}
  where $C \pbrac{\sigma}$ denotes the set of cycles of $\sigma$ and the inner product is taken with respect to any choice of linearization of the cyclic order of the elements of $c$.
\end{theorem}

The situation for the $\symgp{k+1}$-species $\pointed[\overline{XY}]{\specname{CT}}_{k}$ is almost identical.
Recall from \S \ref{ss:actct} that $\sigma \in \symgp{k+1}$ acts on a $\pointed[\overline{XY}]{\specname{CT}}_{k}$-structure $T$ by applying $\sigma$ directly to the linear order on the $k+1$ white neighbors of the root black vertex and applying $\rho$-variants of $\sigma$ recursively to their descendants.
Thus, we once again need only require that, along each cycle of $\sigma$, the successive white-vertex structures are pairwise isomorphic under the action of the appropriate $\rho_{i} \pbrac{\sigma}$.
Thus, we again need only choose for each cycle $c \in C \pbrac{\sigma}$ a $\pointed[Y]{\specname{CT}}_{k}$-structure which is invariant under $\prod_{i \in c} \rho_{i} \pbrac{\sigma}$.
Accordingly:
\begin{theorem}
  \label{thm:ctxyfuncci}
  The $\symgp{k+1}$-cycle index for the species $\pointed[\overline{XY}]{\specname{CT}}_{k}$ is given by
  \begin{multline}
    \label{eq:ctxyfuncci}
    \gci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} = p_{1} \sbrac{x} \\
    \times \prod_{c \in C \pbrac{\sigma}} \gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\prod_{i \in c} \rho_{i} \sbrac{\sigma}} \sbrac{p_{\abs{c}} \sbrac{x}, p_{2 \abs{c}} \sbrac{x}, \dots, p_{\abs{c}} \sbrac{y}, p_{2 \abs{c}} \sbrac{y}, \dots}.
  \end{multline}
  under the same conditions as Theorem \ref{thm:ctyfuncci}.
\end{theorem}

\subsection{$k$-trees: $\mathfrak{a}_{k}$}\label{ss:ktcycind}
We now have all the pieces in hand to apply Theorem \ref{thm:dissymkci} to compute the cycle index of the species $\mathfrak{a}_{k}$ of general $k$-trees.
Equation \eqref{eq:dissymkci} characterizes the cycle index of the generic $k$-tree species $\mathfrak{a}_{k}$ in terms of the cycle indices of the rooted species $\pointed[X]{\mathfrak{a}}_{k}$, $\pointed[Y]{\mathfrak{a}}_{k}$, and $\pointed[\overline{XY}]{\mathfrak{a}}_{k}$; Theorem \ref{thm:arootquot} gives the cycle indices of these three rooted species in terms of the $\Gamma$-cycle indices $\gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}}$, $\gci{\symgp{k}}{\pointed[\overline{XY}]{\specname{CT}}_{k}}$, and $\gci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}}$; and, finally, Theorems \ref{thm:ctyfuncci} and \ref{thm:ctxyfuncci} give these $\Gamma$-cycle indices explicitly.
By tracing the formulas in equations \ref{eq:ctyfuncci} and \ref{eq:ctxyfuncci} back through this sequence of functional relationships, we can conclude:
\begin{theorem}[Cycle index for the species of $k$-trees]
  \label{thm:akci}
  For $\specname{a}_{k}$ the species of general $k$-trees, $\gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}}$ as in equation \eqref{eq:ctyfuncci}, and $\gci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}}$ as in equation \eqref{eq:ctxyfuncci} we have:
  \label{thm:ktreecyc}
  \begin{subequations}
    \label{eq:akci}
    \begin{align}
      \ci{\mathfrak{a}_{k}} &= \frac{1}{\pbrac{k+1}!} \sum_{\sigma \in \symgp{k+1}} \gci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} + \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \gci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\sigma} - \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \gci{\symgp{k}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} \label{eq:akciexplicit} \\
      &= \qgci{\symgp{k+1}}{\pointed[\overline{XY}]{\specname{CT}}_{k}} + \qgci{\symgp{k}}{\pointed[Y]{\specname{CT}}_{k}} - \qgci{\symgp{k}}{\pointed[\overline{XY}]{\specname{CT}}_{k}}. \label{eq:akciquot}
    \end{align}
  \end{subequations}

\end{theorem}

Since the formulas for the $\Gamma$-cycle indices of $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ are recursive, equation \eqref{eq:akci} in fact represents a recursive system of functional equations.
Computational methods, as discussed in \S \ref{s:comprecurs}, can yield explicit enumerative results.
However, a bit of care will allow us to reduce the computational complexity of this problem significantly.

\section{Unlabeled enumeration and the generating function $\tilde{\mathfrak{a}}_{k} \pbrac{x}$}
Equation \eqref{eq:akci} in Theorem \ref{thm:akci} gives an explicit (albeit recursive) formula for the cycle index of the ordinary species $\mathfrak{a}_{k}$ of $k$-trees.
The number of unlabeled $k$-trees with $n$ hedra is historically an open problem, but by application of Theorem \ref{thm:ciogf} the ordinary generating function counting such structures can be extracted from the cycle index $\ci{\mathfrak{a}_{k}}$.
Actually computing terms of the cycle index in order to derive the coefficients of the generating function is, however, a computationally expensive process, since the cycle index is by construction a power series in two infinite sets of variables.
The computational process can be simplified significantly by taking advantage of the relatively straightforward combinatorial structure of the structural decomposition used to derive the recursive formulas for the cycle index.

Recall from Theorem \ref{thm:gciogf} that, for a $\Gamma$-species $F$, the ordinary generating function $\tilde{F}_{\gamma} \pbrac{x}$ counting unlabeled $\gamma$-invariant $F$-structures is given by
\[\tilde{F} \pbrac{\gamma} \pbrac{x} = \ci{F} \sbrac{x, x^2, x^3, \dots}\]
and that the ordinary generating function for counting unlabeled $\nicefrac{F}{\Gamma}$-structures is given by
\[\tilde{F} \pbrac{x} = \frac{1}{\abs{\Gamma}} \sum_{\gamma \in \Gamma} \tilde{F}_{\gamma} \pbrac{x}.\]
These formula admits an obvious multisort extension, but we in fact wish to count $k$-trees with respect to just one sort of label (the $X$-labels on hedra), so we will not deal with multisort here.
Each of the two-sort cycle indices in this chapter can be converted to one-sort by substituting $y_{i} = 1$ for all $i$.
For the rest of this section, we will deal directly with these one-sort versions of the cycle indices.

We begin by considering the explicit recursive functional equations in Theorems \ref{thm:ctyfuncci} and \ref{thm:ctxyfuncci}.
In each case, by the above, the ordinary generating function is exactly the result of substituting $p_{i} \sbrac{x} = x^{i}$ into the given formula.
Thus, we have:
\begin{theorem}
  \label{thm:ctogf}
  For $\pointed[Y]{\specname{CT}}_{k}$ the $\symgp{k}$-species of $Y$-rooted $k$-coding trees and $\pointed[\overline{XY}]{\specname{CT}}_{k}$ the $\symgp{k+1}$-species of edge-rooted $k$-coding trees, the corresponding ordinary generating functions are given by
  \begin{align}
    \widetilde{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\sigma} \pbrac{x} &= \exp \pbrac{ \sum_{n \geq 1} \frac{x^{n}}{n} \cdot \prod_{c \in C \pbrac{\sigma^{n}}} \widetilde{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\prod_{i \in c} \rho_{i} \pbrac{\sigma^{n}}} \pbrac{x^{\abs{c}}}} \label{eq:ctyogf} \\
    \widetilde{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} \pbrac{x} &= x \cdot \prod_{c \in C \pbrac{\sigma}} \widetilde{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\prod_{i \in c} \rho_{i} \pbrac{\sigma}} \pbrac{x^{\abs{c}}}. \label{eq:ctxyogf}
  \end{align}
\end{theorem}
As in Theorem \ref{thm:ctyfuncci}, we have recursively-defined functional equations, but these are recursions of power series in a single variable, so computing their terms is much less computationally expensive.

Moreover, the cycle index of the species $\mathfrak{a}_{k}$, as seen in equation \eqref{eq:akci}, is given simply in terms of quotients of the cycle indices of the two $\Gamma$-species $\pointed[Y]{\specname{CT}}_{k}$ and $\pointed[\overline{XY}]{\specname{CT}}_{k}$.
Thus, we also have:
\begin{theorem}
  \label{thm:akogf}
  For $\mathfrak{a}_{k}$ the species of $k$-trees and $\widetilde{\pointed[Y]{\specname{CT}}_{k}}$ and $\widetilde{\pointed[\overline{XY}]{\specname{CT}}_{k}}$ as in Theorem \ref{thm:ctogf}, we have
  \begin{equation}
    \label{eq:akogf}
    \tilde{\mathfrak{a}}_{k} \pbrac{x} = \frac{1}{\pbrac{k+1}!} \sum_{\sigma \in \symgp{k+1}} \widetilde{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma} + \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \widetilde{\pointed[Y]{\specname{CT}}_{k}} \pbrac{\sigma} - \frac{1}{k!} \sum_{\sigma \in \symgp{k}} \widetilde{\pointed[\overline{XY}]{\specname{CT}}_{k}} \pbrac{\sigma}.
  \end{equation}
\end{theorem}

This direct characterization of the ordinary generating function of unlabeled $k$-trees, while still recursive, is much computationally simpler than the characterization of the full cycle index in equation \eqref{eq:akci}.
For computation of the number of unlabeled $k$-trees, it is therefore much preferred.
Classical methods for working with recursively-defined power series suffice to extract the coefficients quickly and efficiently.
The results of some such explicit calculations are presented in \S \ref{s:ktenum}.

\section{Special-case behavior for small $k$}
Many of the complexities of the preceding analysis apply only for $k$ sufficiently large.
We note here some simplifications that are possible when $k$ is small.

\subsection{Ordinary trees ($k = 1$)}
When $k = 1$, an $\mathfrak{a}_{k}$-structure is merely an ordinary tree with $X$-labels on its edges and $Y$-labels on its vertices.
There is no internal symmetry of the form that the actions of $\symgp{k}$ are intended to break.
The actions of $\symgp{2}$ act on ordinary trees rooted at a \emph{directed} edge, with the nontrivial element $\tau \in \symgp{2}$ acting by reversing this orientation.
The resulting decomposition from the dissymmetry theorem \ref{thm:dissymk} and the recursive functional equations of Theorem \ref{thm:funcdecompct} then clearly reduce to the classical dissymmetry analysis of ordinary trees.

\subsection{$2$-trees}
When $k=2$, there is a nontrivial symmetry at fronts (edges); two triangles may be joined at an edge in two distinct ways.
The imposition of a coherent orientation on a $2$-tree by directing one of its edges breaks this symmetry; the action of $\symgp{2}$ by reversal of these orientations gives unoriented $2$-trees as its orbits.
The defined action of $\symgp{3}$ on edge-rooted oriented triangles is simply the classical action of the dihedral group $D_{6}$ on a triangle, and its orbits are unoriented, unrooted triangles.
We further note that $\rho_{i}$ is the trivial map on $\symgp{2}$ and that $\rho_{i} \pbrac{\sigma} = \tau$ for $\sigma \in \symgp{3}$ if and only if $\sigma$ is an odd permutation, both regardless of $i$.
We then have that:
\begin{subequations}
  \label{eq:rest2trees}
  \begin{align}
    \gci{\symgp{2}}{\pointed[Y]{\specname{CT}}_{2}} &= p_{1} \sbrac{y} \cdot Z_{\specname{E}} \circ \pbrac{p_{1} \sbrac{x} \cdot \prod_{c \in C \pbrac{\sigma}} \gci{\symgp{2}}{\pointed[Y]{\specname{CT}}_{2}} \pbrac{e} \sbrac{p_{\abs{c}} \sbrac{x}, p_{2 \abs{c}} \sbrac{x}, \dots; p_{\abs{c}} \sbrac{y}, p_{2 \abs{c}} \sbrac{y}, \dots}} \label{eq:ctyfuncci2} \\
    \gci{\symgp{3}}{\pointed[\overline{XY}]{\specname{CT}}_{2}} &= p_{1} \sbrac{x} \cdot \prod_{c \in C \pbrac{\sigma}} \gci{\symgp{2}}{\pointed[Y]{\specname{CT}}_{2}} \pbrac{\rho \pbrac{\sigma}^{\abs{c}}} \sbrac{p_{\abs{c}} \sbrac{x}, p_{2 \abs{c}} \sbrac{x}, \dots; p_{\abs{c}} \sbrac{y}, p_{2 \abs{c}} \sbrac{y}, \dots}. \label{eq:ctxyfuncci2}
  \end{align}
\end{subequations}
where, by abuse of notation, we let $\rho$ represent any $\rho_{i}$.
By the previous, the argument $\rho \pbrac{\sigma}^{\abs{c}}$ in Equation \eqref{eq:ctxyfuncci2} is $\tau$ if and only if $\sigma$ is an odd permutation and $c$ is of odd length.
This analysis and the resulting formulas for the cycle index $\ci{\mathfrak{a}_{2}}$ are essentially equivalent to those derived in \cite{gessel:spec2trees}.

\subsection{$3$-trees}
TODO: Is there anything to be said here?

\section{Asymptotics}
TODO: Write this!

\appendix
\chapter{Computation in species theory}\label{c:comp}
\section{Cycle indices of recursively-defined species}\label{s:comprecurs}
TODO: Write this!

\section{Cycle indices of compositional inverse species}\label{s:compinv}
In \S \ref{s:nbp}, our results included two references to the compositional inverse $\specname{CBP}^{\bullet \abrac{-1}}$ of the species $\specname{CBP}^{\bullet}$.
Although we have not explored computational methods in depth here, the question of how to compute the cycle index of the compositional inverse of a specified species efficiently is worth some consideration.
Several methods are available, including one developed in \cite[4.2.19]{bll:species} as part of the proof that arbitrary species have compositional inverses, but our preferred method is one of iterated substitution.

Suppose that $\Psi$ is a species (with known cycle index) of the form $X + \Psi_{2} + \Psi_{3} + \dots$ where $\Psi_{i}$ is the restriction of $\Psi$ to structures on sets of cardinality $i$ and that $\Phi$ is the compositional inverse of $\Psi$.
Then $\Psi \circ \Phi = X$ by definition, but by hypothesis
\begin{equation*}
  X = \Psi \circ \Phi = \Phi + \Psi_{2} \pbrac{\Phi} + \Psi_{3} \pbrac{\Phi} + \dots
\end{equation*}
also. Thus
\begin{equation}
  \label{eq:compinv}
  \Phi = X - \Psi_{2} \pbrac{\Phi} - \Psi_{3} \pbrac{\Phi} - \dots.
\end{equation}
This recursive equation is the key to our computational method.
To compute the cycle index of $\Phi$ to degree $2$, we begin with the approximation $\Phi \approx X$ and then substitute it into the first two terms of equation \eqref{eq:compinv}: $\Phi \approx X - \Psi_{2} \pbrac{X}$ and thus $\ci{\Phi} \approx \ci{X} - \ci{\Psi_{2}} \circ \ci{X}$.
All terms of degree up to two in this approximation will be correct.
To compute the cycle index of $\Phi$ to degree $3$, we then take this new approximation $\Phi \approx X - \Psi_{2} \pbrac{X}$ and substitute it into the first three terms of equation \eqref{eq:compinv}.
This process can be iterated as many times as are needed; to determine all terms of degree up to $n$ correctly, we need only iterate $n$ times.
With appropriate optimizations (in particular, truncations), this method can run very quickly on a personal computer to reasonably high degrees; we were able to compute $\ci{\specname{CBP}^{\bullet \abrac{-1}}}$ to degree sixteen in thirteen seconds.

\chapter{Enumerative tables}\label{c:enum}
\section{Bicolored and bipartite graphs}\label{s:bpenum}
With the tools developed in \S \ref{c:bpblocks}, we can calculate the cycle indices of the species $\mathcal{BC}$, $\mathcal{BP}$, and their nonseparable variants to any degree we choose using computational methods.
These cycle indices can then be used to enumerate both labeled and unlabeled structures of each type up to a specified number of vertices.
We have done so here for each species for $n \leq 10$ using Maple 13; the code used is available on request from the first author.
The resulting values appear in Table \ref{tab:bcgraphs}.
Note that most of these sequences appear in the historical literature and on \cite{oeis}; where the latter holds, we have included a citation here.

\begin{table}[htb]
  \centering
  \caption{Enumerative data for bicolored and bipartite graphs (TODO: clean up typesetting)}
  \label{tab:bcgraphs}
  \subfloat[Bicolored graphs ($\mathcal{BC}$)]{
    \label{tab:bc}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Labeled \\ \hline
      1 & 2 & 2 \\
      2 & 4 & 6 \\
      3 & 8 & 26 \\
      4 & 17 & 162 \\
      5 & 38 & 1442 \\
      6 & 94 & 18306 \\
      7 & 258 & 330626 \\
      8 & 815 & 8488926 \\
      9 & 3038 & 309465602 \\
      10 & 13804 & 16011372546 \\
      OEIS & \cite[A049312]{oeis} & \cite[A047863]{oeis}
    \end{tabular}
  }
  \qquad
  \subfloat[Connected bicolored graphs ($\mathcal{CBC}$)]{
    \label{tab:cbc}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Labeled \\ \hline
      1 & 2 & 2 \\
      2 & 1 & 2 \\
      3 & 2 & 6 \\
      4 & 4 & 38 \\
      5 & 10 & 390 \\
      6 & 27 & 6062 \\
      7 & 88 & 134526 \\
      8 & 328 & 4172198 \\
      9 & 1460 & 1784499270 \\
      10 & 7799 & 10508108222 \\
      OEIS & & \cite[A002027]{oeis}
    \end{tabular}
  }
  \\
  \subfloat[Connected bipartite graphs ($\mathcal{CBP}$)]{
    \label{tab:cbp}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Labeled \\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 1 & 3 \\
      4 & 3 & 19 \\
      5 & 5 & 195 \\
      6 & 17 & 3031 \\
      7 & 44 & 67263 \\
      8 & 182 & 2086099 \\
      9 & 730 & 89224653 \\
      10 & 4032 & 5254054111 \\
      OEIS & \cite[A005142]{oeis} & \cite[A001832]{oeis}
    \end{tabular}
  }
  \qquad
  \subfloat[Bipartite graphs ($\mathcal{BP}$)]{
    \label{tab:bp}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Labeled \\ \hline
      1 & 1 & 1 \\
      2 & 2 & 2 \\
      3 & 3 & 7 \\
      4 & 7 & 41 \\
      5 & 13 & 376 \\
      6 & 35 & 5177 \\
      7 & 88 & 103237 \\
      8 & 303 & 2922446 \\
      9 & 1119 & 116011231 \\
      10 & 5479 & 6433447397 \\
      OEIS & \cite[A033995]{oeis} & \cite[A047864]{oeis}
    \end{tabular}
  }
  \\
  \subfloat[Nonseparable bipartite graphs ($\mathcal{NBP}$)]{
    \label{tab:nbp}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Labeled \\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 0 & 0 \\
      4 & 1 & 3 \\
      5 & 1 & 10 \\
      6 & 5 & 355 \\
      7 & 8 & 6986 \\
      8 & 42 & 297619 \\
      9 & 146 & 15077658 \\
      10 & 956 & 1120452771 \\
      OEIS & & \cite[A004100]{oeis}
    \end{tabular}
  }
\end{table}

\section{$k$-trees}\label{s:ktenum}
With the recursive functional equations for cycle indices of \S \ref{s:ktcycind}, we can calculate the explicit cycle index for the species $\mathfrak{a}_{k}$ to any finite degree we choose using computational methods; this cycle index can then be used to enumerate both unlabeled and labeled (at fronts, hedra, or both) $k$-trees up to a specified number $n$ of hedra (or, equivalently, $kn + 1$ fronts).
We have done so here for $k \leq 7$ and $n \leq 12$ using Maple 13 and a few minutes of computation time on a modern desktop computer; the code used is available from the first author on request.
The resulting values appear in Table \ref{tab:ktrees}.

We note that both unlabeled and hedron-labeled enumerations of $k$-trees stabilize:
\begin{theorem}
  \label{thm:ktreestab}
  For $k \geq n + 2$, the numbers of unlabeled and hedron-labeled $k$-trees are independent of $k$.
\end{theorem}
\begin{proof}
  We show that the species $\mathfrak{a}_{k}$ and $\mathfrak{a}_{k+1}$ have contact up to order $k+2$ by explicitly constructing a natural bijection.
  We note that in a $\pbrac{k+1}$-tree with no more than $k+2$ hedra, there will exist at least one vertex which is common to \emph{all} hedra.
  For any $k$-tree with no more than $k+2$ hedra, we can construct a $\pbrac{k+1}$-tree with the same number of hedra by adding a single vertex and connecting it by edges to every existing vertex; we can then pass labels up from the $\pbrac{k+1}$-cliques which are the hedra of the $k$-tree to the $\pbrac{k+2}$-cliques which now sit over them.
  The resulting graph will be a $\pbrac{k+1}$-tree whose $\pbrac{k+1}$-tree hedra are adjacent exactly when the $k$-tree hedra they came from were adjacent.
  Therefore, any two distinct $k$-trees will pass to distinct $\pbrac{k+1}$-trees.
  Similarly, for any $\pbrac{k+1}$-tree with no more than $k+2$ hedra, choose one of the vertices common to all the hedra and remove it, passing the labels of $\pbrac{k+1}$-tree hedra down to the $k$-tree hedra constructed from them; again, adjacency of hedra is preserved.
  This of course creates a $k$-tree, and for distinct $\pbrac{k+1}$-trees the resulting $k$-trees will be distinct.
  Moreover, by symmetry the result is independent of the choice of common vertex, in the case there is more than one.
\end{proof}
However, thus far we have neither determined a direct method for computing these stabilization numbers nor identified a straightforward combinatorial characterization of the structures they represent.

Note that several of the small-$k$ sequences appear in historical work and in \cite{oeis}.
We have included citations to the latter where appropriate.

\begin{table}[htb]
  \centering
  \caption{Enumerative data for $k$-trees with $n$ hedra (TODO: clean up typesetting)}
  \label{tab:ktrees}

  \subfloat[$k = 1$]{
    \label{tab:1trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\ 
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 3 & 25 \\
      5 & 6 & 216 \\
      6 & 11 & 2401 \\
      7 & 23 & 32768 \\
      8 & 47 & 531441 \\
      9 & 106 & 10000000 \\
      10 & 235 & 214358881 \\
      11 & 551 & 5159780352 \\
      12 & 1301 & 137858491849 \\
      OEIS & \cite[A000055]{oeis} & \cite[A007830]{oeis}
    \end{tabular}
  }
  \qquad
  \subfloat[$k = 2$]{
    \label{tab:2trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 12 & 666 \\
      6 & 39 & 14281 \\
      7 & 136 & 379688 \\
      8 & 529 & 12068785 \\
      9 & 2171 & 446935870 \\
      10 & 9368 & 18911429681 \\
      11 & 41534 & 900576330732 \\
      12 & 118942 & 47683714820313 \\
      OEIS & \cite[A054581]{oeis} & 
    \end{tabular}
  }
  \\
  \subfloat[$k = 3$]{
    \label{tab:3trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 15 & 791 \\
      6 & 58 & 22921 \\
      7 & 275 & 875323 \\
      8 & 1505 & 40955825 \\
      9 & 9003 & 2253821419 \\
      10 & 56931 & 142255685681 \\
      11 & 372973 & 10122078684587 \\
      12 & 2506312 & 801499657982233 \\
      OEIS & \cite[AA078792]{oeis} & 
    \end{tabular}
  }
  \qquad
  \subfloat[$k = 4$]{
    \label{tab:4trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 15 & 791 \\
      6 & 64 & 24217 \\
      7 & 331 & 1055398 \\
      8 & 2150 & 60022705 \\
      9 & 15817 & 4182296149 \\
      10 & 127194 & 342232385681 \\
      11 & 1077639 & 10122078684587 \\
      12 & 9466983 & 801499657982233 \\
      OEIS & \cite[A078793]{oeis} & 
    \end{tabular}
  }
\end{table}

\begin{table}[htb]
  \centering
  \ContinuedFloat
  \caption*{Enumerative data for $k$-trees with $n$ hedra, continued}
  \subfloat[$k = 5$]{
    \label{tab:5trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 15 & 791 \\
      6 & 64 & 24217 \\
      7 & 342 & 1072205 \\
      8 & 2321 & 64151473 \\
      9 & 18578 & 4908953143 \\
      10 & 168287 & 45885785681 \\
      11 & 1656209 & 50496621826289 \\
      12 & 17288336 & 6361185897100057
    \end{tabular}
  }
  \qquad
  \subfloat[$k = 6$]{
    \label{tab:6trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled\\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 15 & 791 \\
      6 & 64 & 24217 \\
      7 & 342 & 1072205 \\
      8 & 2344 & 64413617 \\
      9 & 19090 & 5013115579 \\
      10 & 179562 & 487165985681 \\
      11 & 1878277 & 57263807690189 \\
      12 & 21365403 & 7916339162469145
    \end{tabular}
  }
  \\
  \subfloat[$k = 7$]{
    \label{tab:7trees}
    \begin{tabular}{r | l l}
      $n$ & Unlabeled & Hedron-labeled \\ \hline
      1 & 1 & 1 \\
      2 & 1 & 1 \\
      3 & 2 & 4 \\
      4 & 5 & 41 \\
      5 & 15 & 791 \\
      6 & 64 & 24217 \\
      7 & 342 & 1072205 \\
      8 & 2344 & 64413617 \\
      9 & 19137 & 5017898548 \\
      10 & 181098 & 490045985681 \\
      11 & 1922215 & 58407899499599 \\
      12 & 22472875 & 8304797526086425
    \end{tabular}
  }
\end{table}

\backmatter

\bibliographystyle{amsplain} %bibliography
\bibliography{sources}

% \printindex

\end{document}